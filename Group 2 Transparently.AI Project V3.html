<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Group 2">
<meta name="dcterms.date" content="2024-04-06">

<title>ACCT420 Forecasting and Forensic Analytics (FFA)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Group 2 Transparently.AI Project V3_files/libs/clipboard/clipboard.min.js"></script>
<script src="Group 2 Transparently.AI Project V3_files/libs/quarto-html/quarto.js"></script>
<script src="Group 2 Transparently.AI Project V3_files/libs/quarto-html/popper.min.js"></script>
<script src="Group 2 Transparently.AI Project V3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Group 2 Transparently.AI Project V3_files/libs/quarto-html/anchor.min.js"></script>
<link href="Group 2 Transparently.AI Project V3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Group 2 Transparently.AI Project V3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Group 2 Transparently.AI Project V3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Group 2 Transparently.AI Project V3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Group 2 Transparently.AI Project V3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link active" data-scroll-target="#data-preparation">1.0 Data Preparation</a>
  <ul class="collapse">
  <li><a href="#loading-libraries" id="toc-loading-libraries" class="nav-link" data-scroll-target="#loading-libraries">1.1. Loading Libraries</a></li>
  <li><a href="#loading-data" id="toc-loading-data" class="nav-link" data-scroll-target="#loading-data">1.2 Loading Data</a>
  <ul class="collapse">
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">1.2.1 Exploratory Data Analysis</a></li>
  <li><a href="#correlation-matrix" id="toc-correlation-matrix" class="nav-link" data-scroll-target="#correlation-matrix">1.2.2 Correlation Matrix</a></li>
  </ul></li>
  <li><a href="#data-pre-processing" id="toc-data-pre-processing" class="nav-link" data-scroll-target="#data-pre-processing">1.3 Data Pre-Processing</a>
  <ul class="collapse">
  <li><a href="#log-numeric-variables" id="toc-log-numeric-variables" class="nav-link" data-scroll-target="#log-numeric-variables">1.3.1 Log Numeric Variables</a></li>
  <li><a href="#removing-rows-with-infinite-values" id="toc-removing-rows-with-infinite-values" class="nav-link" data-scroll-target="#removing-rows-with-infinite-values">1.3.2 Removing rows with Infinite Values</a></li>
  <li><a href="#checking-skewness-of-variables-log-to-normalise-it-if-the-skewness-is-1" id="toc-checking-skewness-of-variables-log-to-normalise-it-if-the-skewness-is-1" class="nav-link" data-scroll-target="#checking-skewness-of-variables-log-to-normalise-it-if-the-skewness-is-1">1.3.3 Checking Skewness of Variables &amp; Log to normalise it if the skewness is &gt;1</a></li>
  <li><a href="#run-skewness-check-log-function-on-the-dataset" id="toc-run-skewness-check-log-function-on-the-dataset" class="nav-link" data-scroll-target="#run-skewness-check-log-function-on-the-dataset">1.3.4 Run Skewness Check &amp; Log function on the dataset</a></li>
  <li><a href="#replacing-all-remaining-na-values-with-the-absolute-mean" id="toc-replacing-all-remaining-na-values-with-the-absolute-mean" class="nav-link" data-scroll-target="#replacing-all-remaining-na-values-with-the-absolute-mean">1.3.5 Replacing all remaining NA values with the Absolute Mean</a></li>
  <li><a href="#removing-all-infinite-values-after-the-log-transformation" id="toc-removing-all-infinite-values-after-the-log-transformation" class="nav-link" data-scroll-target="#removing-all-infinite-values-after-the-log-transformation">1.3.6 Removing all Infinite Values after the log transformation</a></li>
  <li><a href="#plot-the-density-and-histograms-to-see-if-our-skew-has-been-rectified" id="toc-plot-the-density-and-histograms-to-see-if-our-skew-has-been-rectified" class="nav-link" data-scroll-target="#plot-the-density-and-histograms-to-see-if-our-skew-has-been-rectified">1.3.7 Plot the Density and Histograms to see if our skew has been rectified</a></li>
  <li><a href="#define-the-train-test-split" id="toc-define-the-train-test-split" class="nav-link" data-scroll-target="#define-the-train-test-split">1.3.8 Define the train test split</a></li>
  <li><a href="#checking-the-number-of-aaers" id="toc-checking-the-number-of-aaers" class="nav-link" data-scroll-target="#checking-the-number-of-aaers">1.3.9 Checking the number of AAERs</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#model-building" id="toc-model-building" class="nav-link" data-scroll-target="#model-building">2.0 Model Building</a>
  <ul class="collapse">
  <li><a href="#xgboost-model" id="toc-xgboost-model" class="nav-link" data-scroll-target="#xgboost-model">2.1 XGBoost Model</a>
  <ul class="collapse">
  <li><a href="#tuning-the-xgboost-model-with-parameter-grid" id="toc-tuning-the-xgboost-model-with-parameter-grid" class="nav-link" data-scroll-target="#tuning-the-xgboost-model-with-parameter-grid">2.1.1 Tuning the XGBoost model with parameter grid</a></li>
  <li><a href="#running-the-xgboost-model-with-optimal-parameters" id="toc-running-the-xgboost-model-with-optimal-parameters" class="nav-link" data-scroll-target="#running-the-xgboost-model-with-optimal-parameters">2.1.2 Running the XGBoost model with optimal parameters</a></li>
  <li><a href="#ranking-important-variables" id="toc-ranking-important-variables" class="nav-link" data-scroll-target="#ranking-important-variables">2.1.3 Ranking Important Variables</a></li>
  <li><a href="#plotting-roc" id="toc-plotting-roc" class="nav-link" data-scroll-target="#plotting-roc">2.1.4 Plotting ROC</a></li>
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix">2.1.5 Confusion Matrix</a></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">2.2 Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#log-reg-1" id="toc-log-reg-1" class="nav-link" data-scroll-target="#log-reg-1">2.2.1 Log Reg 1</a></li>
  <li><a href="#log-reg-2---no-item-3255" id="toc-log-reg-2---no-item-3255" class="nav-link" data-scroll-target="#log-reg-2---no-item-3255">2.2.2 Log Reg 2 - No Item 3255</a></li>
  <li><a href="#log-reg-3---no-item-8361" id="toc-log-reg-3---no-item-8361" class="nav-link" data-scroll-target="#log-reg-3---no-item-8361">2.2.3 Log Reg 3 - No Item 8361</a></li>
  <li><a href="#log-reg-4---no-item-8301" id="toc-log-reg-4---no-item-8301" class="nav-link" data-scroll-target="#log-reg-4---no-item-8301">2.2.4 Log Reg 4 - No Item 8301</a></li>
  <li><a href="#log-reg-5---no-item-18156" id="toc-log-reg-5---no-item-18156" class="nav-link" data-scroll-target="#log-reg-5---no-item-18156">2.2.5 Log Reg 5 - No Item 18156</a></li>
  <li><a href="#log-reg-6---no-item-3995" id="toc-log-reg-6---no-item-3995" class="nav-link" data-scroll-target="#log-reg-6---no-item-3995">2.2.6 Log Reg 6 - No Item 3995</a></li>
  <li><a href="#measureables-of-the-6-log-reg-models-in-a-table-for-easier-comparison" id="toc-measureables-of-the-6-log-reg-models-in-a-table-for-easier-comparison" class="nav-link" data-scroll-target="#measureables-of-the-6-log-reg-models-in-a-table-for-easier-comparison">2.2.7 Measureables of the 6 Log Reg Models in a table for easier comparison</a></li>
  <li><a href="#log-reg-2.1" id="toc-log-reg-2.1" class="nav-link" data-scroll-target="#log-reg-2.1">2.2.8 Log Reg 2.1</a></li>
  <li><a href="#log-reg-2.2" id="toc-log-reg-2.2" class="nav-link" data-scroll-target="#log-reg-2.2">2.2.9 Log Reg 2.2</a></li>
  <li><a href="#log-reg-4.1" id="toc-log-reg-4.1" class="nav-link" data-scroll-target="#log-reg-4.1">2.2.10 Log Reg 4.1</a></li>
  <li><a href="#log-reg-4.2" id="toc-log-reg-4.2" class="nav-link" data-scroll-target="#log-reg-4.2">2.2.11 Log Reg 4.2</a></li>
  <li><a href="#log-reg-4.3" id="toc-log-reg-4.3" class="nav-link" data-scroll-target="#log-reg-4.3">2.2.12 Log Reg 4.3</a></li>
  <li><a href="#comparing-auc-of-all-models" id="toc-comparing-auc-of-all-models" class="nav-link" data-scroll-target="#comparing-auc-of-all-models">2.2.13 Comparing AUC of all models</a></li>
  <li><a href="#plotting-auc" id="toc-plotting-auc" class="nav-link" data-scroll-target="#plotting-auc">2.2.14 Plotting AUC</a></li>
  <li><a href="#log-reg-4.2-on-all-data" id="toc-log-reg-4.2-on-all-data" class="nav-link" data-scroll-target="#log-reg-4.2-on-all-data">2.2.15 Log Reg 4.2 ON ALL DATA</a></li>
  </ul></li>
  <li><a href="#lasso" id="toc-lasso" class="nav-link" data-scroll-target="#lasso">2.3 Lasso</a>
  <ul class="collapse">
  <li><a href="#cv.glm-lasso-based-on-log-fit-4" id="toc-cv.glm-lasso-based-on-log-fit-4" class="nav-link" data-scroll-target="#cv.glm-lasso-based-on-log-fit-4">2.3.1 CV.GLM Lasso based on Log Fit 4</a></li>
  <li><a href="#test-the-performance-of-the-cv-lasso-model" id="toc-test-the-performance-of-the-cv-lasso-model" class="nav-link" data-scroll-target="#test-the-performance-of-the-cv-lasso-model">2.3.2 Test the performance of the CV Lasso model</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">3.0 Conclusion</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ACCT420 Forecasting and Forensic Analytics (FFA)</h1>
<p class="subtitle lead">Transparently.AI Group Project</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Group 2 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 6, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="data-preparation" class="level1">
<h1>1.0 Data Preparation</h1>
<p>Do note that the final data set <code>banks_cleaned_with_aaer.rds</code> has undergone pre-processing steps. You can find these scripts under the <code>data_wrangling_scripts</code>folder, which contains 2 different scripts:</p>
<ol type="1">
<li><code>join_AAER_banks.Rmd</code>: This script joins the AAER data with the banks data and cleans the NA/INF/NAN values.</li>
<li><code>join_items_banks_aaer.Rmd</code>: This script joins the AAER_banks data with additional variables extracted from Wharton DB. It also cleans the NA/INF/NAN values.</li>
</ol>
<section id="loading-libraries" class="level2">
<h2 class="anchored" data-anchor-id="loading-libraries">1.1. Loading Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(recipes)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parsnip)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coefplot)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-data">1.2 Loading Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#u may need to change the directory</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>banks <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"C:/Users/Ryan Goh/Desktop/FFA-13 PROJECT GROUP2/finalised_data/banks_cleaned_with_aaer.rds"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>banks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 37,662 × 37
    year code   ITEM6001         ITEM6010 ITEM7240 ITEM19109 ITEM19110 ITEM19111
   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;            &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1  2004 100008 ASYA KATILIM BA… 4          2.32e8 11645627. 28230316.   -4.41e7
 2  2005 100008 ASYA KATILIM BA… 4          3.48e8 11645627. 28230316.   -4.41e7
 3  2006 100008 ASYA KATILIM BA… 4          5.49e8 11645627. 35429528.   -4.41e7
 4  2007 100008 ASYA KATILIM BA… 4          8.71e8 11645627. 68365639.   -4.41e7
 5  2008 100008 ASYA KATILIM BA… 4          1.18e9 11645627. 68687944    -4.41e7
 6  2009 100008 ASYA KATILIM BA… 4          1.19e9 11645627. 85235280    -4.41e7
 7  2010 100008 ASYA KATILIM BA… 4          1.11e9 11645627. 74099609.   -4.41e7
 8  2011 100008 ASYA KATILIM BA… 4          1.05e9 11645627. 63659356    -4.41e7
 9  2012 100008 ASYA KATILIM BA… 4          1.25e9 11645627. 25748490.    2.69e7
10  2013 100008 ASYA KATILIM BA… 4          1.34e9 20986304. 29170478.    3.26e7
# ℹ 37,652 more rows
# ℹ 29 more variables: ITEM19112 &lt;dbl&gt;, ITEM8236 &lt;dbl&gt;, ITEM8301 &lt;dbl&gt;,
#   ITEM3255 &lt;dbl&gt;, ITEM3999 &lt;dbl&gt;, ITEM8231 &lt;dbl&gt;, ITEM8381 &lt;dbl&gt;,
#   ITEM8311 &lt;dbl&gt;, ITEM8316 &lt;dbl&gt;, ITEM8906 &lt;dbl&gt;, ITEM8361 &lt;dbl&gt;,
#   ITEM15025 &lt;dbl&gt;, ITEM15061 &lt;dbl&gt;, ITEM15073 &lt;dbl&gt;, ITEM15156 &lt;dbl&gt;,
#   ITEM15173 &lt;dbl&gt;, ITEM7546 &lt;fct&gt;, ITEM9104 &lt;dbl&gt;, ITEM9304 &lt;dbl&gt;,
#   ITEM3998 &lt;dbl&gt;, ITEM18156 &lt;dbl&gt;, ITEM3995 &lt;dbl&gt;, ITEM2004 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<section id="exploratory-data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis">1.2.1 Exploratory Data Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>banks <span class="sc">%&gt;%</span> <span class="fu">introduce</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 9
   rows columns discrete_columns continuous_columns all_missing_columns
  &lt;int&gt;   &lt;int&gt;            &lt;int&gt;              &lt;int&gt;               &lt;int&gt;
1 37662      37                6                 31                   0
# ℹ 4 more variables: total_missing_values &lt;int&gt;, complete_rows &lt;int&gt;,
#   total_observations &lt;int&gt;, memory_usage &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>banks <span class="sc">%&gt;%</span> <span class="fu">plot_missing</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>banks <span class="sc">%&gt;%</span> <span class="fu">profile_missing</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 37 × 3
   feature   num_missing pct_missing
   &lt;fct&gt;           &lt;int&gt;       &lt;dbl&gt;
 1 year                0           0
 2 code                0           0
 3 ITEM6001            0           0
 4 ITEM6010            0           0
 5 ITEM7240            0           0
 6 ITEM19109           0           0
 7 ITEM19110           0           0
 8 ITEM19111           0           0
 9 ITEM19112           0           0
10 ITEM8236            0           0
# ℹ 27 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>banks <span class="sc">%&gt;%</span> <span class="fu">plot_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>banks <span class="sc">%&gt;%</span> <span class="fu">plot_intro</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>banks <span class="sc">%&gt;%</span> <span class="fu">plot_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-3-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-3-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>banks <span class="sc">%&gt;%</span> <span class="fu">plot_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-3-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-3-7.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Observations</em>:</p>
<ol type="1">
<li>There are no missing values as they have already been replaced by either the group column mean or absolute mean or removed in the case of infinite values.</li>
<li>The vast majority of our variables are continuous.</li>
<li>The density plot of the majority of our variables are right or left skewed, hence we need to normalise them.</li>
</ol>
</section>
<section id="correlation-matrix" class="level3">
<h3 class="anchored" data-anchor-id="correlation-matrix">1.2.2 Correlation Matrix</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(banks[<span class="fu">sapply</span>(banks,is.numeric)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      year      ITEM7240     ITEM19109
year                          1.0000000000  8.462203e-03  3.904081e-02
ITEM7240                      0.0084622032  1.000000e+00  1.102911e-01
ITEM19109                     0.0390408097  1.102911e-01  1.000000e+00
ITEM19110                     0.0438266634  1.890206e-03  4.456964e-01
ITEM19111                     0.0200523376  2.985376e-01  4.737591e-01
ITEM19112                     0.0058266459  3.075382e-01  3.433703e-01
ITEM8236                     -0.0028103953 -1.923475e-04 -1.394514e-03
ITEM8301                      0.0026576307  2.754938e-01  3.104186e-01
ITEM3255                      0.0212469917  1.910948e-03  2.707731e-01
ITEM3999                      0.0500313907  2.567868e-03  3.745956e-01
ITEM8231                      0.0056460964 -5.090289e-05 -3.615599e-06
ITEM8381                     -0.0048407951 -6.909041e-02 -7.491790e-02
ITEM8311                      0.0003728064  1.950017e-05  1.516615e-03
ITEM8316                      0.0016600663  1.463600e-04  1.314888e-03
ITEM8906                      0.0072672202 -1.389125e-04 -2.057629e-03
ITEM8361                      0.0046835464  3.025794e-01  3.380135e-01
ITEM15025                     0.0162067265  4.650953e-05 -1.046144e-03
ITEM15061                     0.0152551692 -9.753160e-04  6.856555e-05
ITEM15073                     0.0083422691  6.895517e-05  1.463675e-03
ITEM15156                     0.0389766112 -8.769803e-04  1.318862e-03
ITEM15173                     0.0095943857 -2.074178e-04  4.134070e-03
ITEM9104                      0.0079420692 -1.267472e-04  3.718858e-03
ITEM9304                     -0.0097351310  1.151236e-06  2.144403e-03
ITEM3998                      0.0389714189  2.064889e-03  2.725623e-01
ITEM18156                     0.0228514003  2.286702e-03  2.992685e-01
ITEM3995                      0.0746937591  3.464283e-03  4.119169e-01
ITEM2004                      0.0685568963  7.131715e-04  2.718295e-01
ITEM3019                      0.0690321031  1.185666e-03  3.391361e-01
leverage_ratio                         NaN           NaN           NaN
total_capital_adequacy_ratio -0.0053341757 -9.082529e-04 -1.449588e-02
cash_to_deposits_ratio                 NaN           NaN           NaN
                                 ITEM19110     ITEM19111     ITEM19112
year                          4.382666e-02  0.0200523376  5.826646e-03
ITEM7240                      1.890206e-03  0.2985375666  3.075382e-01
ITEM19109                     4.456964e-01  0.4737591017  3.433703e-01
ITEM19110                     1.000000e+00  0.1158285695 -1.193664e-03
ITEM19111                     1.158286e-01  1.0000000000  9.393419e-01
ITEM19112                    -1.193664e-03  0.9393418789  1.000000e+00
ITEM8236                     -2.108646e-03 -0.0006387208 -2.550173e-04
ITEM8301                      8.134648e-04  0.8416040793  8.680487e-01
ITEM3255                      3.486050e-01  0.0627271188 -1.203485e-03
ITEM3999                      5.179199e-01  0.0981344289 -1.716119e-03
ITEM8231                     -8.826395e-04  0.0014459748 -6.134569e-05
ITEM8381                      1.896272e-03 -0.2109377505 -2.176879e-01
ITEM8311                      4.866291e-04 -0.0007717637  3.541997e-06
ITEM8316                      1.770152e-03  0.0004398034  1.741472e-04
ITEM8906                      3.114942e-06 -0.0004040822 -1.589286e-04
ITEM8361                     -1.192518e-03  0.9245457873  9.535449e-01
ITEM15025                    -2.585255e-03 -0.0003210328  1.625238e-06
ITEM15061                    -2.641205e-03 -0.0011192525 -1.329512e-03
ITEM15073                     8.053729e-04  0.0004930994  1.525563e-04
ITEM15156                    -3.201356e-03 -0.0026650416 -4.437243e-03
ITEM15173                     1.033919e-02  0.0006122217 -3.810299e-04
ITEM9104                      2.306269e-03  0.0005969213  7.440214e-06
ITEM9304                      2.266061e-03  0.0007349139  2.503151e-05
ITEM3998                      3.343312e-01  0.0658828265 -1.058375e-03
ITEM18156                     4.056229e-01  0.0835097038 -7.890586e-04
ITEM3995                      5.491989e-01  0.1139352531 -1.735835e-03
ITEM2004                      3.673249e-01  0.0770180459 -1.567156e-03
ITEM3019                      4.614664e-01  0.0950355200 -1.255435e-03
leverage_ratio                         NaN           NaN           NaN
total_capital_adequacy_ratio -2.986457e-02 -0.0055069253 -1.300256e-03
cash_to_deposits_ratio                 NaN           NaN           NaN
                                  ITEM8236      ITEM8301      ITEM3255
year                         -2.810395e-03  2.657631e-03  0.0212469917
ITEM7240                     -1.923475e-04  2.754938e-01  0.0019109484
ITEM19109                    -1.394514e-03  3.104186e-01  0.2707730800
ITEM19110                    -2.108646e-03  8.134648e-04  0.3486049645
ITEM19111                    -6.387208e-04  8.416041e-01  0.0627271188
ITEM19112                    -2.550173e-04  8.680487e-01 -0.0012034854
ITEM8236                      1.000000e+00 -1.899349e-04 -0.0002412900
ITEM8301                     -1.899349e-04  1.000000e+00 -0.0002729695
ITEM3255                     -2.412900e-04 -2.729695e-04  1.0000000000
ITEM3999                     -2.347353e-03  1.455490e-03  0.6459214519
ITEM8231                      9.753197e-05  4.135861e-05 -0.0005696574
ITEM8381                      9.870073e-05  1.560475e-01  0.0005776784
ITEM8311                     -5.368458e-04  1.612759e-03  0.0002099133
ITEM8316                     -7.889056e-03  7.501104e-04  0.0018189603
ITEM8906                      1.090565e-04  3.081541e-04 -0.0001577109
ITEM8361                     -7.069841e-05  9.059158e-01 -0.0017381236
ITEM15025                     1.145506e-04  1.679240e-04  0.0182944407
ITEM15061                    -4.466204e-05 -8.364852e-04  0.0015639026
ITEM15073                     7.098752e-05  1.491287e-04  0.0014644096
ITEM15156                    -8.077453e-04 -4.398583e-03 -0.0073584971
ITEM15173                    -1.421054e-03  1.033787e-04  0.0042265632
ITEM9104                     -3.989165e-02  3.018032e-04  0.0031447930
ITEM9304                     -3.809448e-04  1.366144e-02  0.0049772620
ITEM3998                     -4.823787e-04  2.983847e-04  0.9346379468
ITEM18156                     1.664996e-03 -6.208562e-04  0.2894007108
ITEM3995                     -3.065098e-03  1.938115e-04  0.3828678209
ITEM2004                     -6.904231e-04 -1.131486e-03  0.2494720701
ITEM3019                     -1.316294e-03 -1.524534e-03  0.3193075629
leverage_ratio                         NaN           NaN           NaN
total_capital_adequacy_ratio -3.509821e-03 -1.342618e-03 -0.0486266706
cash_to_deposits_ratio                 NaN           NaN           NaN
                                  ITEM3999      ITEM8231      ITEM8381
year                          0.0500313907  5.646096e-03 -4.840795e-03
ITEM7240                      0.0025678682 -5.090289e-05 -6.909041e-02
ITEM19109                     0.3745955815 -3.615599e-06 -7.491790e-02
ITEM19110                     0.5179198890 -8.826395e-04  1.896272e-03
ITEM19111                     0.0981344289  1.445975e-03 -2.109378e-01
ITEM19112                    -0.0017161193 -6.134569e-05 -2.176879e-01
ITEM8236                     -0.0023473525  9.753197e-05  9.870073e-05
ITEM8301                      0.0014554896  4.135861e-05  1.560475e-01
ITEM3255                      0.6459214519 -5.696574e-04  5.776784e-04
ITEM3999                      1.0000000000 -9.621941e-04  2.094381e-04
ITEM8231                     -0.0009621941  1.000000e+00  1.410899e-04
ITEM8381                      0.0002094381  1.410899e-04  1.000000e+00
ITEM8311                      0.0003872122 -6.007741e-06  2.737246e-03
ITEM8316                      0.0028791003  8.294033e-05  2.456217e-04
ITEM8906                     -0.0012635077 -8.713554e-05  2.988160e-05
ITEM8361                     -0.0001755391 -3.893581e-05 -2.035892e-01
ITEM15025                     0.0027082254 -9.219459e-07 -2.680454e-04
ITEM15061                    -0.0006696108 -6.507918e-07 -5.737383e-03
ITEM15073                     0.0021495427 -2.567237e-04  4.957469e-05
ITEM15156                     0.0047749581  3.986249e-02 -1.258852e-03
ITEM15173                     0.0151756449 -9.374174e-07 -1.369937e-04
ITEM9104                      0.0010486845  6.621120e-07  2.969044e-04
ITEM9304                      0.0019443050  3.397585e-06  2.367511e-03
ITEM3998                      0.6133574284 -5.083019e-04  2.860383e-04
ITEM18156                     0.5500010117 -1.523284e-03 -5.821858e-04
ITEM3995                      0.7623117851 -1.172480e-03  1.849329e-04
ITEM2004                      0.5178074008 -1.473165e-04  2.697500e-04
ITEM3019                      0.6374636130 -1.101400e-03  1.978673e-04
leverage_ratio                         NaN           NaN           NaN
total_capital_adequacy_ratio -0.0574542292 -5.741103e-05  2.861419e-03
cash_to_deposits_ratio                 NaN           NaN           NaN
                                  ITEM8311      ITEM8316      ITEM8906
year                          3.728064e-04  1.660066e-03  7.267220e-03
ITEM7240                      1.950017e-05  1.463600e-04 -1.389125e-04
ITEM19109                     1.516615e-03  1.314888e-03 -2.057629e-03
ITEM19110                     4.866291e-04  1.770152e-03  3.114942e-06
ITEM19111                    -7.717637e-04  4.398034e-04 -4.040822e-04
ITEM19112                     3.541997e-06  1.741472e-04 -1.589286e-04
ITEM8236                     -5.368458e-04 -7.889056e-03  1.090565e-04
ITEM8301                      1.612759e-03  7.501104e-04  3.081541e-04
ITEM3255                      2.099133e-04  1.818960e-03 -1.577109e-04
ITEM3999                      3.872122e-04  2.879100e-03 -1.263508e-03
ITEM8231                     -6.007741e-06  8.294033e-05 -8.713554e-05
ITEM8381                      2.737246e-03  2.456217e-04  2.988160e-05
ITEM8311                      1.000000e+00  1.259039e-02  3.571262e-04
ITEM8316                      1.259039e-02  1.000000e+00  1.392615e-04
ITEM8906                      3.571262e-04  1.392615e-04  1.000000e+00
ITEM8361                      2.998901e-04  6.288134e-04 -5.192061e-05
ITEM15025                     5.343917e-05  2.565506e-04 -1.184077e-03
ITEM15061                    -5.340556e-05  1.506588e-04 -6.669194e-04
ITEM15073                    -5.522265e-06  1.233388e-04 -1.008749e-04
ITEM15156                     1.600735e-03  1.656951e-03 -6.619596e-04
ITEM15173                    -1.420837e-03 -3.230793e-04  1.888567e-02
ITEM9104                     -6.547322e-04  7.128203e-04  1.333889e-04
ITEM9304                     -1.454079e-03  2.420053e-02 -4.237162e-04
ITEM3998                      2.396940e-04  1.879449e-03  5.704156e-04
ITEM18156                     9.181615e-06  5.599616e-04 -1.251927e-03
ITEM3995                      3.968448e-04  3.326682e-03 -1.398324e-03
ITEM2004                      4.345264e-03 -2.976970e-03 -2.344720e-03
ITEM3019                     -3.036327e-03 -5.934962e-04 -2.181743e-03
leverage_ratio                         NaN           NaN           NaN
total_capital_adequacy_ratio -1.389055e-04 -7.403749e-04 -6.606697e-03
cash_to_deposits_ratio                 NaN           NaN           NaN
                                  ITEM8361     ITEM15025     ITEM15061
year                          4.683546e-03  1.620673e-02  1.525517e-02
ITEM7240                      3.025794e-01  4.650953e-05 -9.753160e-04
ITEM19109                     3.380135e-01 -1.046144e-03  6.856555e-05
ITEM19110                    -1.192518e-03 -2.585255e-03 -2.641205e-03
ITEM19111                     9.245458e-01 -3.210328e-04 -1.119252e-03
ITEM19112                     9.535449e-01  1.625238e-06 -1.329512e-03
ITEM8236                     -7.069841e-05  1.145506e-04 -4.466204e-05
ITEM8301                      9.059158e-01  1.679240e-04 -8.364852e-04
ITEM3255                     -1.738124e-03  1.829444e-02  1.563903e-03
ITEM3999                     -1.755391e-04  2.708225e-03 -6.696108e-04
ITEM8231                     -3.893581e-05 -9.219459e-07 -6.507918e-07
ITEM8381                     -2.035892e-01 -2.680454e-04 -5.737383e-03
ITEM8311                      2.998901e-04  5.343917e-05 -5.340556e-05
ITEM8316                      6.288134e-04  2.565506e-04  1.506588e-04
ITEM8906                     -5.192061e-05 -1.184077e-03 -6.669194e-04
ITEM8361                      1.000000e+00 -7.449513e-05  2.491869e-02
ITEM15025                    -7.449513e-05  1.000000e+00  3.347301e-04
ITEM15061                     2.491869e-02  3.347301e-04  1.000000e+00
ITEM15073                     1.951981e-04  2.437927e-04  1.138330e-02
ITEM15156                    -4.269944e-03  5.084230e-03  3.562802e-02
ITEM15173                    -6.740232e-04 -1.097515e-03 -1.149274e-03
ITEM9104                     -8.159971e-05  1.256152e-03  9.606160e-05
ITEM9304                      5.032366e-03 -2.137419e-04  6.307331e-04
ITEM3998                     -3.032505e-04  1.920495e-02  6.549666e-04
ITEM18156                    -9.519553e-04 -1.682396e-03  2.507487e-03
ITEM3995                      7.402505e-04  8.921519e-04  2.733458e-04
ITEM2004                     -1.119609e-03 -2.189073e-03 -1.262448e-04
ITEM3019                     -2.865345e-03 -3.221134e-03  1.679264e-03
leverage_ratio                         NaN           NaN           NaN
total_capital_adequacy_ratio -2.116660e-03 -1.802279e-03 -1.938467e-03
cash_to_deposits_ratio                 NaN           NaN           NaN
                                 ITEM15073     ITEM15156     ITEM15173
year                          8.342269e-03  0.0389766112  9.594386e-03
ITEM7240                      6.895517e-05 -0.0008769803 -2.074178e-04
ITEM19109                     1.463675e-03  0.0013188622  4.134070e-03
ITEM19110                     8.053729e-04 -0.0032013562  1.033919e-02
ITEM19111                     4.930994e-04 -0.0026650416  6.122217e-04
ITEM19112                     1.525563e-04 -0.0044372431 -3.810299e-04
ITEM8236                      7.098752e-05 -0.0008077453 -1.421054e-03
ITEM8301                      1.491287e-04 -0.0043985829  1.033787e-04
ITEM3255                      1.464410e-03 -0.0073584971  4.226563e-03
ITEM3999                      2.149543e-03  0.0047749581  1.517564e-02
ITEM8231                     -2.567237e-04  0.0398624928 -9.374174e-07
ITEM8381                      4.957469e-05 -0.0012588519 -1.369937e-04
ITEM8311                     -5.522265e-06  0.0016007353 -1.420837e-03
ITEM8316                      1.233388e-04  0.0016569514 -3.230793e-04
ITEM8906                     -1.008749e-04 -0.0006619596  1.888567e-02
ITEM8361                      1.951981e-04 -0.0042699437 -6.740232e-04
ITEM15025                     2.437927e-04  0.0050842298 -1.097515e-03
ITEM15061                     1.138330e-02  0.0356280163 -1.149274e-03
ITEM15073                     1.000000e+00  0.0260721789  1.170200e-04
ITEM15156                     2.607218e-02  1.0000000000  4.015179e-03
ITEM15173                     1.170200e-04  0.0040151793  1.000000e+00
ITEM9104                     -2.015814e-04 -0.0027564697 -9.569396e-04
ITEM9304                     -2.960757e-04 -0.0011103193  2.517713e-03
ITEM3998                      1.167963e-03 -0.0057085139  3.920533e-03
ITEM18156                     3.460734e-03 -0.0029039242  9.034181e-03
ITEM3995                      2.642741e-03 -0.0029909281  1.095985e-02
ITEM2004                      2.464809e-03  0.0001667689  1.887968e-03
ITEM3019                      2.394604e-03  0.0069559902  1.348627e-02
leverage_ratio                         NaN           NaN           NaN
total_capital_adequacy_ratio -3.806276e-03  0.0099830075 -2.962530e-03
cash_to_deposits_ratio                 NaN           NaN           NaN
                                  ITEM9104      ITEM9304      ITEM3998
year                          7.942069e-03 -9.735131e-03  0.0389714189
ITEM7240                     -1.267472e-04  1.151236e-06  0.0020648888
ITEM19109                     3.718858e-03  2.144403e-03  0.2725623101
ITEM19110                     2.306269e-03  2.266061e-03  0.3343311855
ITEM19111                     5.969213e-04  7.349139e-04  0.0658828265
ITEM19112                     7.440214e-06  2.503151e-05 -0.0010583750
ITEM8236                     -3.989165e-02 -3.809448e-04 -0.0004823787
ITEM8301                      3.018032e-04  1.366144e-02  0.0002983847
ITEM3255                      3.144793e-03  4.977262e-03  0.9346379468
ITEM3999                      1.048685e-03  1.944305e-03  0.6133574284
ITEM8231                      6.621120e-07  3.397585e-06 -0.0005083019
ITEM8381                      2.969044e-04  2.367511e-03  0.0002860383
ITEM8311                     -6.547322e-04 -1.454079e-03  0.0002396940
ITEM8316                      7.128203e-04  2.420053e-02  0.0018794487
ITEM8906                      1.333889e-04 -4.237162e-04  0.0005704156
ITEM8361                     -8.159971e-05  5.032366e-03 -0.0003032505
ITEM15025                     1.256152e-03 -2.137419e-04  0.0192049460
ITEM15061                     9.606160e-05  6.307331e-04  0.0006549666
ITEM15073                    -2.015814e-04 -2.960757e-04  0.0011679631
ITEM15156                    -2.756470e-03 -1.110319e-03 -0.0057085139
ITEM15173                    -9.569396e-04  2.517713e-03  0.0039205329
ITEM9104                      1.000000e+00  1.529685e-01  0.0027617842
ITEM9304                      1.529685e-01  1.000000e+00  0.0042701850
ITEM3998                      2.761784e-03  4.270185e-03  1.0000000000
ITEM18156                     2.050048e-03  5.873821e-04  0.2453677597
ITEM3995                      2.436991e-03  2.525845e-03  0.4104421554
ITEM2004                     -6.225094e-04 -1.257715e-03  0.2053386306
ITEM3019                      2.484377e-04 -1.197444e-03  0.2685081105
leverage_ratio                         NaN           NaN           NaN
total_capital_adequacy_ratio -1.221268e-03  8.165984e-04 -0.0411638481
cash_to_deposits_ratio                 NaN           NaN           NaN
                                 ITEM18156      ITEM3995      ITEM2004
year                          2.285140e-02  0.0746937591  0.0685568963
ITEM7240                      2.286702e-03  0.0034642831  0.0007131715
ITEM19109                     2.992685e-01  0.4119169352  0.2718294966
ITEM19110                     4.056229e-01  0.5491988929  0.3673249239
ITEM19111                     8.350970e-02  0.1139352531  0.0770180459
ITEM19112                    -7.890586e-04 -0.0017358352 -0.0015671563
ITEM8236                      1.664996e-03 -0.0030650981 -0.0006904231
ITEM8301                     -6.208562e-04  0.0001938115 -0.0011314860
ITEM3255                      2.894007e-01  0.3828678209  0.2494720701
ITEM3999                      5.500010e-01  0.7623117851  0.5178074008
ITEM8231                     -1.523284e-03 -0.0011724798 -0.0001473165
ITEM8381                     -5.821858e-04  0.0001849329  0.0002697500
ITEM8311                      9.181615e-06  0.0003968448  0.0043452639
ITEM8316                      5.599616e-04  0.0033266817 -0.0029769697
ITEM8906                     -1.251927e-03 -0.0013983244 -0.0023447195
ITEM8361                     -9.519553e-04  0.0007402505 -0.0011196093
ITEM15025                    -1.682396e-03  0.0008921519 -0.0021890729
ITEM15061                     2.507487e-03  0.0002733458 -0.0001262448
ITEM15073                     3.460734e-03  0.0026427415  0.0024648088
ITEM15156                    -2.903924e-03 -0.0029909281  0.0001667689
ITEM15173                     9.034181e-03  0.0109598458  0.0018879685
ITEM9104                      2.050048e-03  0.0024369909 -0.0006225094
ITEM9304                      5.873821e-04  0.0025258453 -0.0012577147
ITEM3998                      2.453678e-01  0.4104421554  0.2053386306
ITEM18156                     1.000000e+00  0.5931349823  0.4299532846
ITEM3995                      5.931350e-01  1.0000000000  0.5085891324
ITEM2004                      4.299533e-01  0.5085891324  1.0000000000
ITEM3019                      5.713500e-01  0.6542275630  0.6155167333
leverage_ratio                         NaN           NaN           NaN
total_capital_adequacy_ratio -5.743585e-02 -0.0429388500 -0.0362252171
cash_to_deposits_ratio                 NaN           NaN           NaN
                                  ITEM3019 leverage_ratio
year                          0.0690321031            NaN
ITEM7240                      0.0011856664            NaN
ITEM19109                     0.3391360740            NaN
ITEM19110                     0.4614663979            NaN
ITEM19111                     0.0950355200            NaN
ITEM19112                    -0.0012554348            NaN
ITEM8236                     -0.0013162944            NaN
ITEM8301                     -0.0015245335            NaN
ITEM3255                      0.3193075629            NaN
ITEM3999                      0.6374636130            NaN
ITEM8231                     -0.0011014005            NaN
ITEM8381                      0.0001978673            NaN
ITEM8311                     -0.0030363268            NaN
ITEM8316                     -0.0005934962            NaN
ITEM8906                     -0.0021817429            NaN
ITEM8361                     -0.0028653447            NaN
ITEM15025                    -0.0032211338            NaN
ITEM15061                     0.0016792638            NaN
ITEM15073                     0.0023946039            NaN
ITEM15156                     0.0069559902            NaN
ITEM15173                     0.0134862740            NaN
ITEM9104                      0.0002484377            NaN
ITEM9304                     -0.0011974437            NaN
ITEM3998                      0.2685081105            NaN
ITEM18156                     0.5713500197            NaN
ITEM3995                      0.6542275630            NaN
ITEM2004                      0.6155167333            NaN
ITEM3019                      1.0000000000            NaN
leverage_ratio                         NaN              1
total_capital_adequacy_ratio -0.0473731106            NaN
cash_to_deposits_ratio                 NaN            NaN
                             total_capital_adequacy_ratio
year                                        -5.334176e-03
ITEM7240                                    -9.082529e-04
ITEM19109                                   -1.449588e-02
ITEM19110                                   -2.986457e-02
ITEM19111                                   -5.506925e-03
ITEM19112                                   -1.300256e-03
ITEM8236                                    -3.509821e-03
ITEM8301                                    -1.342618e-03
ITEM3255                                    -4.862667e-02
ITEM3999                                    -5.745423e-02
ITEM8231                                    -5.741103e-05
ITEM8381                                     2.861419e-03
ITEM8311                                    -1.389055e-04
ITEM8316                                    -7.403749e-04
ITEM8906                                    -6.606697e-03
ITEM8361                                    -2.116660e-03
ITEM15025                                   -1.802279e-03
ITEM15061                                   -1.938467e-03
ITEM15073                                   -3.806276e-03
ITEM15156                                    9.983008e-03
ITEM15173                                   -2.962530e-03
ITEM9104                                    -1.221268e-03
ITEM9304                                     8.165984e-04
ITEM3998                                    -4.116385e-02
ITEM18156                                   -5.743585e-02
ITEM3995                                    -4.293885e-02
ITEM2004                                    -3.622522e-02
ITEM3019                                    -4.737311e-02
leverage_ratio                                        NaN
total_capital_adequacy_ratio                 1.000000e+00
cash_to_deposits_ratio                                NaN
                             cash_to_deposits_ratio
year                                            NaN
ITEM7240                                        NaN
ITEM19109                                       NaN
ITEM19110                                       NaN
ITEM19111                                       NaN
ITEM19112                                       NaN
ITEM8236                                        NaN
ITEM8301                                        NaN
ITEM3255                                        NaN
ITEM3999                                        NaN
ITEM8231                                        NaN
ITEM8381                                        NaN
ITEM8311                                        NaN
ITEM8316                                        NaN
ITEM8906                                        NaN
ITEM8361                                        NaN
ITEM15025                                       NaN
ITEM15061                                       NaN
ITEM15073                                       NaN
ITEM15156                                       NaN
ITEM15173                                       NaN
ITEM9104                                        NaN
ITEM9304                                        NaN
ITEM3998                                        NaN
ITEM18156                                       NaN
ITEM3995                                        NaN
ITEM2004                                        NaN
ITEM3019                                        NaN
leverage_ratio                                  NaN
total_capital_adequacy_ratio                    NaN
cash_to_deposits_ratio                            1</code></pre>
</div>
</div>
<p><em>Observations</em>:</p>
<p>Instances where correlation &gt; 0.80:</p>
<ol type="1">
<li>ITEM3998 (Total Capital) &amp; ITEM3255 (Total Debt)</li>
<li>ITEM8361 (Operating Income Return on Total Capital) &amp; ITEM8301 (Return on Equity - Total (%)</li>
<li>ITEM18156 (Risk Weighted Assets) &amp; ITEM3995 (Total Shareholders Equity)</li>
</ol>
<p>To prevent multicollinearity, we excluded these pairings from our logistic models.</p>
</section>
</section>
<section id="data-pre-processing" class="level2">
<h2 class="anchored" data-anchor-id="data-pre-processing">1.3 Data Pre-Processing</h2>
<section id="log-numeric-variables" class="level3">
<h3 class="anchored" data-anchor-id="log-numeric-variables">1.3.1 Log Numeric Variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we re-scaled some variables for better readability and also calculated the total net_profit_margin for the year.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>banks <span class="ot">&lt;-</span> banks <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">net_profit_margin =</span> (ITEM19109<span class="sc">+</span>ITEM19110<span class="sc">+</span>ITEM19111<span class="sc">+</span>ITEM19112)<span class="sc">/</span><span class="dv">1000000</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITEM7240 =</span> ITEM7240<span class="sc">/</span><span class="dv">1000000</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITEM3255 =</span> ITEM3255<span class="sc">/</span><span class="dv">1000000</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITEM3999 =</span> ITEM3999<span class="sc">/</span><span class="dv">1000000</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITEM18156 =</span> ITEM18156<span class="sc">/</span><span class="dv">1000000</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITEM3995 =</span> ITEM3995<span class="sc">/</span><span class="dv">1000000</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITEM2004 =</span> ITEM2004<span class="sc">/</span><span class="dv">1000000</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITEM3019 =</span> ITEM3019<span class="sc">/</span><span class="dv">1000000</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITEM3998 =</span> ITEM3998<span class="sc">/</span><span class="dv">1000000</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove Items 19109-19112</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>banks <span class="ot">&lt;-</span> <span class="fu">subset</span>(banks, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(ITEM19109,ITEM19110,ITEM19111,ITEM19112,cash_to_deposits_ratio,code,ITEM6001,ITEM6010))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>banks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 37,662 × 30
    year ITEM7240 ITEM8236 ITEM8301 ITEM3255 ITEM3999 ITEM8231 ITEM8381 ITEM8311
   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2004     232.    1.57     13.3      22.3    1418.    19.0     30.3     31.0 
 2  2005     348.    0.814    37.5      15.8    1944.     7.20    64.4     31.2 
 3  2006     549.    8.42     32.9     107.     3015.    23.0     56.0     34.8 
 4  2007     871.    5.24     24.9     281.     5357.    39.0     53.0     36.0 
 5  2008    1181.    5.70     21.4     301.     5282.    33.7     15.5     10.6 
 6  2009    1186.    8.42     17.4     129.     7642.    11.8     31.5     26.5 
 7  2010    1111.    8.42     13.3     431.     9228.    36.0     18.1     18.6 
 8  2011    1055.   11.1      10.1     999.     8980.    93.1      4.34     4.67
 9  2012    1248.    9.20      7.11   1080.    11748.    88.4     37.3     34.3 
10  2013    1339.   18.6       7.72   2417.    12988.   207.      32.0     28.6 
# ℹ 37,652 more rows
# ℹ 21 more variables: ITEM8316 &lt;dbl&gt;, ITEM8906 &lt;dbl&gt;, ITEM8361 &lt;dbl&gt;,
#   ITEM15025 &lt;dbl&gt;, ITEM15061 &lt;dbl&gt;, ITEM15073 &lt;dbl&gt;, ITEM15156 &lt;dbl&gt;,
#   ITEM15173 &lt;dbl&gt;, ITEM7546 &lt;fct&gt;, ITEM9104 &lt;dbl&gt;, ITEM9304 &lt;dbl&gt;,
#   ITEM3998 &lt;dbl&gt;, ITEM18156 &lt;dbl&gt;, ITEM3995 &lt;dbl&gt;, ITEM2004 &lt;dbl&gt;,
#   ITEM3019 &lt;dbl&gt;, big4_auditor &lt;fct&gt;, leverage_ratio &lt;dbl&gt;,
#   total_capital_adequacy_ratio &lt;dbl&gt;, AAER &lt;fct&gt;, net_profit_margin &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="removing-rows-with-infinite-values" class="level3">
<h3 class="anchored" data-anchor-id="removing-rows-with-infinite-values">1.3.2 Removing rows with Infinite Values</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the 5 rows with infinite values</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>banks[<span class="fu">rowSums</span>(<span class="fu">sapply</span>(banks, is.infinite)) <span class="sc">&gt;</span> <span class="dv">0</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 30
   year ITEM7240 ITEM8236 ITEM8301 ITEM3255 ITEM3999 ITEM8231 ITEM8381 ITEM8311
  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1  2013     40.2     81.1     12.9    299.      368.    644.      12.7     11.3
2  2014     77.0     71.8     12.9    598.      833.    644.      12.7     21.3
3  2013     41.5     89.0     10.6    187.      210.    106.     197.      17.1
4  2010   1057.      76.0     10.0     36.4    9152.     65.1     13.1     15.3
5  2023   1057.      76.0     10.0     36.4    9152.     65.1     13.1     15.3
# ℹ 21 more variables: ITEM8316 &lt;dbl&gt;, ITEM8906 &lt;dbl&gt;, ITEM8361 &lt;dbl&gt;,
#   ITEM15025 &lt;dbl&gt;, ITEM15061 &lt;dbl&gt;, ITEM15073 &lt;dbl&gt;, ITEM15156 &lt;dbl&gt;,
#   ITEM15173 &lt;dbl&gt;, ITEM7546 &lt;fct&gt;, ITEM9104 &lt;dbl&gt;, ITEM9304 &lt;dbl&gt;,
#   ITEM3998 &lt;dbl&gt;, ITEM18156 &lt;dbl&gt;, ITEM3995 &lt;dbl&gt;, ITEM2004 &lt;dbl&gt;,
#   ITEM3019 &lt;dbl&gt;, big4_auditor &lt;fct&gt;, leverage_ratio &lt;dbl&gt;,
#   total_capital_adequacy_ratio &lt;dbl&gt;, AAER &lt;fct&gt;, net_profit_margin &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the rows with infinite values</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>banks <span class="ot">&lt;-</span> banks[<span class="sc">!</span><span class="fu">is.infinite</span>(banks<span class="sc">$</span>leverage_ratio),]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>banks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 37,657 × 30
    year ITEM7240 ITEM8236 ITEM8301 ITEM3255 ITEM3999 ITEM8231 ITEM8381 ITEM8311
   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2004     232.    1.57     13.3      22.3    1418.    19.0     30.3     31.0 
 2  2005     348.    0.814    37.5      15.8    1944.     7.20    64.4     31.2 
 3  2006     549.    8.42     32.9     107.     3015.    23.0     56.0     34.8 
 4  2007     871.    5.24     24.9     281.     5357.    39.0     53.0     36.0 
 5  2008    1181.    5.70     21.4     301.     5282.    33.7     15.5     10.6 
 6  2009    1186.    8.42     17.4     129.     7642.    11.8     31.5     26.5 
 7  2010    1111.    8.42     13.3     431.     9228.    36.0     18.1     18.6 
 8  2011    1055.   11.1      10.1     999.     8980.    93.1      4.34     4.67
 9  2012    1248.    9.20      7.11   1080.    11748.    88.4     37.3     34.3 
10  2013    1339.   18.6       7.72   2417.    12988.   207.      32.0     28.6 
# ℹ 37,647 more rows
# ℹ 21 more variables: ITEM8316 &lt;dbl&gt;, ITEM8906 &lt;dbl&gt;, ITEM8361 &lt;dbl&gt;,
#   ITEM15025 &lt;dbl&gt;, ITEM15061 &lt;dbl&gt;, ITEM15073 &lt;dbl&gt;, ITEM15156 &lt;dbl&gt;,
#   ITEM15173 &lt;dbl&gt;, ITEM7546 &lt;fct&gt;, ITEM9104 &lt;dbl&gt;, ITEM9304 &lt;dbl&gt;,
#   ITEM3998 &lt;dbl&gt;, ITEM18156 &lt;dbl&gt;, ITEM3995 &lt;dbl&gt;, ITEM2004 &lt;dbl&gt;,
#   ITEM3019 &lt;dbl&gt;, big4_auditor &lt;fct&gt;, leverage_ratio &lt;dbl&gt;,
#   total_capital_adequacy_ratio &lt;dbl&gt;, AAER &lt;fct&gt;, net_profit_margin &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="checking-skewness-of-variables-log-to-normalise-it-if-the-skewness-is-1" class="level3">
<h3 class="anchored" data-anchor-id="checking-skewness-of-variables-log-to-normalise-it-if-the-skewness-is-1">1.3.3 Checking Skewness of Variables &amp; Log to normalise it if the skewness is &gt;1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get names of all numeric columns</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="ot">&lt;-</span> <span class="fu">names</span>(banks)[<span class="fu">sapply</span>(banks, is.numeric)][<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>check_and_log_transform <span class="ot">&lt;-</span> <span class="cf">function</span>(data, skew_threshold) {</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Get the column names of all numeric columns</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  numeric_columns <span class="ot">&lt;-</span> <span class="fu">names</span>(data)[<span class="fu">sapply</span>(data, is.numeric)][<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Create a copy of the data</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  transformed_data <span class="ot">&lt;-</span> data</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col <span class="cf">in</span> numeric_columns) {</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>          skew <span class="ot">=</span> <span class="fu">skewness</span>(data[[col]], <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">abs</span>(skew) <span class="sc">&gt;</span> skew_threshold) {</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>             transformed_data[[col]] <span class="ot">&lt;-</span> <span class="fu">log</span>(data[[col]])</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(transformed_data)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="run-skewness-check-log-function-on-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="run-skewness-check-log-function-on-the-dataset">1.3.4 Run Skewness Check &amp; Log function on the dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>banks <span class="ot">&lt;-</span> <span class="fu">check_and_log_transform</span>(banks,<span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>banks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 37,657 × 30
    year ITEM7240 ITEM8236 ITEM8301 ITEM3255 ITEM3999 ITEM8231 ITEM8381 ITEM8311
   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2004     5.45    0.451     2.58     3.10     7.26     2.94     3.41     3.43
 2  2005     5.85   -0.206     3.62     2.76     7.57     1.97     4.16     3.44
 3  2006     6.31    2.13      3.49     4.67     8.01     3.14     4.03     3.55
 4  2007     6.77    1.66      3.22     5.64     8.59     3.66     3.97     3.58
 5  2008     7.07    1.74      3.07     5.71     8.57     3.52     2.74     2.36
 6  2009     7.08    2.13      2.86     4.86     8.94     2.47     3.45     3.28
 7  2010     7.01    2.13      2.59     6.07     9.13     3.58     2.89     2.92
 8  2011     6.96    2.41      2.31     6.91     9.10     4.53     1.47     1.54
 9  2012     7.13    2.22      1.96     6.99     9.37     4.48     3.62     3.54
10  2013     7.20    2.92      2.04     7.79     9.47     5.33     3.47     3.35
# ℹ 37,647 more rows
# ℹ 21 more variables: ITEM8316 &lt;dbl&gt;, ITEM8906 &lt;dbl&gt;, ITEM8361 &lt;dbl&gt;,
#   ITEM15025 &lt;dbl&gt;, ITEM15061 &lt;dbl&gt;, ITEM15073 &lt;dbl&gt;, ITEM15156 &lt;dbl&gt;,
#   ITEM15173 &lt;dbl&gt;, ITEM7546 &lt;fct&gt;, ITEM9104 &lt;dbl&gt;, ITEM9304 &lt;dbl&gt;,
#   ITEM3998 &lt;dbl&gt;, ITEM18156 &lt;dbl&gt;, ITEM3995 &lt;dbl&gt;, ITEM2004 &lt;dbl&gt;,
#   ITEM3019 &lt;dbl&gt;, big4_auditor &lt;fct&gt;, leverage_ratio &lt;dbl&gt;,
#   total_capital_adequacy_ratio &lt;dbl&gt;, AAER &lt;fct&gt;, net_profit_margin &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="replacing-all-remaining-na-values-with-the-absolute-mean" class="level3">
<h3 class="anchored" data-anchor-id="replacing-all-remaining-na-values-with-the-absolute-mean">1.3.5 Replacing all remaining NA values with the Absolute Mean</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace the NA values of hrswork with the mean of the remaining values</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> numeric_columns) {</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  banks[[col]][<span class="fu">is.na</span>(banks[[col]])] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(banks[[col]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># See the results</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>banks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 37,657 × 30
    year ITEM7240 ITEM8236 ITEM8301 ITEM3255 ITEM3999 ITEM8231 ITEM8381 ITEM8311
   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2004     5.45    0.451     2.58     3.10     7.26     2.94     3.41     3.43
 2  2005     5.85   -0.206     3.62     2.76     7.57     1.97     4.16     3.44
 3  2006     6.31    2.13      3.49     4.67     8.01     3.14     4.03     3.55
 4  2007     6.77    1.66      3.22     5.64     8.59     3.66     3.97     3.58
 5  2008     7.07    1.74      3.07     5.71     8.57     3.52     2.74     2.36
 6  2009     7.08    2.13      2.86     4.86     8.94     2.47     3.45     3.28
 7  2010     7.01    2.13      2.59     6.07     9.13     3.58     2.89     2.92
 8  2011     6.96    2.41      2.31     6.91     9.10     4.53     1.47     1.54
 9  2012     7.13    2.22      1.96     6.99     9.37     4.48     3.62     3.54
10  2013     7.20    2.92      2.04     7.79     9.47     5.33     3.47     3.35
# ℹ 37,647 more rows
# ℹ 21 more variables: ITEM8316 &lt;dbl&gt;, ITEM8906 &lt;dbl&gt;, ITEM8361 &lt;dbl&gt;,
#   ITEM15025 &lt;dbl&gt;, ITEM15061 &lt;dbl&gt;, ITEM15073 &lt;dbl&gt;, ITEM15156 &lt;dbl&gt;,
#   ITEM15173 &lt;dbl&gt;, ITEM7546 &lt;fct&gt;, ITEM9104 &lt;dbl&gt;, ITEM9304 &lt;dbl&gt;,
#   ITEM3998 &lt;dbl&gt;, ITEM18156 &lt;dbl&gt;, ITEM3995 &lt;dbl&gt;, ITEM2004 &lt;dbl&gt;,
#   ITEM3019 &lt;dbl&gt;, big4_auditor &lt;fct&gt;, leverage_ratio &lt;dbl&gt;,
#   total_capital_adequacy_ratio &lt;dbl&gt;, AAER &lt;fct&gt;, net_profit_margin &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="removing-all-infinite-values-after-the-log-transformation" class="level3">
<h3 class="anchored" data-anchor-id="removing-all-infinite-values-after-the-log-transformation">1.3.6 Removing all Infinite Values after the log transformation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> numeric_columns){</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>   banks <span class="ot">&lt;-</span> banks[<span class="sc">!</span><span class="fu">is.infinite</span>(banks[[col]]),]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>banks </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19,330 × 30
    year ITEM7240 ITEM8236 ITEM8301 ITEM3255 ITEM3999 ITEM8231 ITEM8381 ITEM8311
   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2004     5.45    0.451     2.58     3.10     7.26     2.94     3.41     3.43
 2  2005     5.85   -0.206     3.62     2.76     7.57     1.97     4.16     3.44
 3  2006     6.31    2.13      3.49     4.67     8.01     3.14     4.03     3.55
 4  2007     6.77    1.66      3.22     5.64     8.59     3.66     3.97     3.58
 5  2008     7.07    1.74      3.07     5.71     8.57     3.52     2.74     2.36
 6  2009     7.08    2.13      2.86     4.86     8.94     2.47     3.45     3.28
 7  2010     7.01    2.13      2.59     6.07     9.13     3.58     2.89     2.92
 8  2011     6.96    2.41      2.31     6.91     9.10     4.53     1.47     1.54
 9  2012     7.13    2.22      1.96     6.99     9.37     4.48     3.62     3.54
10  2016     6.82    2.13      2.58     6.41     8.81     4.13     3.41     3.11
# ℹ 19,320 more rows
# ℹ 21 more variables: ITEM8316 &lt;dbl&gt;, ITEM8906 &lt;dbl&gt;, ITEM8361 &lt;dbl&gt;,
#   ITEM15025 &lt;dbl&gt;, ITEM15061 &lt;dbl&gt;, ITEM15073 &lt;dbl&gt;, ITEM15156 &lt;dbl&gt;,
#   ITEM15173 &lt;dbl&gt;, ITEM7546 &lt;fct&gt;, ITEM9104 &lt;dbl&gt;, ITEM9304 &lt;dbl&gt;,
#   ITEM3998 &lt;dbl&gt;, ITEM18156 &lt;dbl&gt;, ITEM3995 &lt;dbl&gt;, ITEM2004 &lt;dbl&gt;,
#   ITEM3019 &lt;dbl&gt;, big4_auditor &lt;fct&gt;, leverage_ratio &lt;dbl&gt;,
#   total_capital_adequacy_ratio &lt;dbl&gt;, AAER &lt;fct&gt;, net_profit_margin &lt;dbl&gt;</code></pre>
</div>
</div>
<p><em>Observations</em>:</p>
<p>After using log transformation to remove all infinite values, it left us with 19,330 rows.</p>
</section>
<section id="plot-the-density-and-histograms-to-see-if-our-skew-has-been-rectified" class="level3">
<h3 class="anchored" data-anchor-id="plot-the-density-and-histograms-to-see-if-our-skew-has-been-rectified">1.3.7 Plot the Density and Histograms to see if our skew has been rectified</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>banks <span class="sc">%&gt;%</span> <span class="fu">plot_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>banks <span class="sc">%&gt;%</span> <span class="fu">plot_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Observations</em>:</p>
<p>The skewness of the graph has been rectified, as evidenced by the graphs now exhibiting a more normal distribution.</p>
</section>
<section id="define-the-train-test-split" class="level3">
<h3 class="anchored" data-anchor-id="define-the-train-test-split">1.3.8 Define the train test split</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a 70/30 train test split</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(banks), <span class="dv">13531</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="sc">-</span>train</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>banks.train <span class="ot">&lt;-</span> banks[train,]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>banks.test <span class="ot">&lt;-</span> banks[test,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Comments</em>:</p>
<p>We chose to use a normal train test split instead of a time-based one because it offers a more representative sample of the data especially in the case of bank fraud detection. When it comes to fraud identification, fraudulent activity patterns and traits might change over time as well. As a result, the complexity and diversity of fraudulent activity may not be sufficiently captured by a time-based split, in which data is separated into training and testing sets according to chronological sequence.</p>
</section>
<section id="checking-the-number-of-aaers" class="level3">
<h3 class="anchored" data-anchor-id="checking-the-number-of-aaers">1.3.9 Checking the number of AAERs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show total number of fraud cases per year for banks</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>total_aaer <span class="ot">&lt;-</span> banks <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_fraud_cases =</span> <span class="fu">sum</span>(AAER <span class="sc">==</span> <span class="dv">1</span>), <span class="at">total_observations =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(total_fraud_cases, total_observations)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>total_aaer <span class="co">#362</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  total_fraud_cases total_observations
              &lt;int&gt;              &lt;int&gt;
1               362              19330</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisations of number of AAERs - 1 &amp; 0</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>banks_AAER_visualisation <span class="ot">&lt;-</span> banks <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(AAER) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AAER =</span> <span class="fu">fct_reorder</span>(AAER, <span class="fu">desc</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> AAER, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> AAER), <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n, <span class="at">y =</span> n <span class="sc">+</span> <span class="dv">200</span>)) </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(banks_AAER_visualisation)  <span class="co"># AAER = 0 (18,968); AAER = 1 (362)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the cell below first</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Total AAER in Train</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>total_aaer_train <span class="ot">&lt;-</span> banks.train <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_fraud_cases =</span> <span class="fu">sum</span>(AAER <span class="sc">==</span> <span class="dv">1</span>), <span class="at">total_observations =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(total_fraud_cases, total_observations)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>total_aaer_train <span class="co">#241 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  total_fraud_cases total_observations
              &lt;int&gt;              &lt;int&gt;
1               241              13531</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total AAER in Test</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>total_aaer_test <span class="ot">&lt;-</span> banks.test <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_fraud_cases =</span> <span class="fu">sum</span>(AAER <span class="sc">==</span> <span class="dv">1</span>), <span class="at">total_observations =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(total_fraud_cases, total_observations)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>total_aaer_test <span class="co">#121 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  total_fraud_cases total_observations
              &lt;int&gt;              &lt;int&gt;
1               121               5799</code></pre>
</div>
</div>
<p><em>Observations</em>:</p>
<p>A total of 362 fraud cases have been observed with 241 in the training set and 121 in the test set.</p>
</section>
</section>
</section>
<section id="model-building" class="level1">
<h1>2.0 Model Building</h1>
<section id="xgboost-model" class="level2">
<h2 class="anchored" data-anchor-id="xgboost-model">2.1 XGBoost Model</h2>
<section id="tuning-the-xgboost-model-with-parameter-grid" class="level3">
<h3 class="anchored" data-anchor-id="tuning-the-xgboost-model-with-parameter-grid">2.1.1 Tuning the XGBoost model with parameter grid</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We have 1 independent and 29 predictor variables.</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># nrounds: number of trees used. Too many trees may cause overfitting</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The max depth of our tree cannot exceed 29. This is because too high of a max depth may cause the trees to memorise the data instead of generating meaningful patterns.</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># learning rate(eta): controls step size at each iteration. Smaller step means better convergence but more computing power is needed. We set the max eta threshold at 0.5 because beyond 0.5 the step size might be too big and the model may not catch the finer details and intricacies in the data. </span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># min_child_weight: min sum of instance weight required to split a node. Setting a higher value for min_child_weight prevents the algorithm from creating child nodes that have fewer instances. This can help control over-fitting by preventing the algorithm from splitting nodes with very few instances, which may lead to overly complex models that memorise noise in the data. Setting a lower value on the other hand can help the model capture the finer details and patterns in the data.</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># colsample_bytree: random fraction of columns to be sub sampled. Number of columns determines how many nodes are in each tree. This takes the value from 0 to 1.</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co"># subsample: fraction of the training samples (randomly selected) that will be used to train each tree. Just like our train test split, we set this to 0.70.</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma: regularisation parameter to control complexity of trees. This specifies the minimum reduction in the loss function required to make a further partition on a leaf node of the tree. If the loss reduction is achieved by splitting a leaf node is less than gamma, the node will not be split, and the tree growing process will stop for that branch. Hence, we set the default to 10 to prevent over-fitting.</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's first define our grid</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Define hyper-parameter grid</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrounds =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_depth =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>),</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">eta =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>),</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="dv">10</span>,</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_child_weight =</span> <span class="dv">5</span>,</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">colsample_bytree =</span> <span class="fl">0.3</span>,</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">subsample =</span> <span class="fl">0.70</span> <span class="co"># same as our train test split</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the training control</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>xgb_trcontrol <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">method=</span><span class="st">"cv"</span>,</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">number =</span> <span class="dv">10</span> <span class="co"># Let's use 10 folds cross validation</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the categorical variables to numeric, this is because matrixes cannot process non-numeric values</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>banks.train3 <span class="ot">&lt;-</span> banks.train <span class="sc">%&gt;%</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">big4_auditor =</span> <span class="fu">as.numeric</span>(big4_auditor),</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITEM7546 =</span> <span class="fu">as.numeric</span>(ITEM7546))</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform grid search</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>xgb_train_1 <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a> <span class="at">x =</span> <span class="fu">as.matrix</span>(banks.train3  <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(AAER, year))),</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a> <span class="at">y =</span> banks.train3<span class="sc">$</span>AAER,</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a> <span class="at">trControl =</span> xgb_trcontrol,</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a> <span class="at">tuneGrid =</span> grid,</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a> <span class="at">method=</span><span class="st">"xgbTree"</span>,</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a> <span class="at">objective=</span> <span class="st">"binary:logistic"</span>,</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a> <span class="at">eval_metric=</span><span class="st">'auc'</span></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[22:14:57] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:14:57] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:14:57] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:14:59] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:14:59] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:14:59] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:01] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:01] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:01] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:03] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:03] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:03] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:04] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:04] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:04] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:06] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:06] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:06] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:08] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:08] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:08] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:10] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:10] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:10] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:11] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:11] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:11] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:12] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:12] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:12] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:20] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:20] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:20] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:22] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:22] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:22] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:24] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:24] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:24] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:26] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:26] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:26] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:28] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:28] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:28] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:30] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:30] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:30] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:31] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:31] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:31] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:35] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:35] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:35] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:37] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:37] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:37] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:39] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:39] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:39] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:40] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:40] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:40] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:42] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:42] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:42] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:45] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:45] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:45] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:46] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:46] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:46] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:48] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:48] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:48] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:50] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:50] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:50] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:51] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:51] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:51] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:53] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:53] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:53] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:54] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:54] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:54] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:55] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:55] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:55] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:59] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:59] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:15:59] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:00] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:00] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:00] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:02] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:02] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:02] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:05] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:05] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:05] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:07] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:07] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:07] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:08] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:08] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:08] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:10] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:10] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:10] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:12] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:12] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:12] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:21] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:21] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:21] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:22] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:22] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:22] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:23] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:23] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:23] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:25] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:25] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:25] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:26] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:26] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:26] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:27] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:27] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:27] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:28] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:28] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:28] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:31] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:31] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:31] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:36] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:36] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:36] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:38] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:38] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:38] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:40] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:40] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:40] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:43] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:43] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:43] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:46] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:46] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:46] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:48] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:48] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:48] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:50] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:50] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:50] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:52] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:52] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:52] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:54] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:54] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:54] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:56] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:56] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:56] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:59] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:59] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:16:59] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:02] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:02] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:02] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:03] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:03] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:03] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:05] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:05] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:05] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:07] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:07] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:07] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:09] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:09] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:09] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:10] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:10] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:10] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:12] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:12] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:12] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:17] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:17] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:17] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:19] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:19] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:19] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:21] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:21] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:21] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:23] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:23] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:23] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:24] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:24] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:24] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:27] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:27] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:27] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:28] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:28] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:28] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:30] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:30] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:30] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:31] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:31] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:31] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:35] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:35] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:35] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:37] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:37] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:37] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:38] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:38] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:38] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:41] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:41] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:41] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:43] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:43] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:43] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:45] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:45] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:45] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:46] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:46] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:46] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:48] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:48] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:48] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:50] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:50] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:50] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:51] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:51] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:51] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:52] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:52] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:52] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:54] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:54] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:54] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:56] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:56] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:56] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:59] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:59] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:17:59] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:01] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:01] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:01] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:03] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:03] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:03] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:05] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:05] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:05] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:07] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:07] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:07] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:08] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:08] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:08] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:10] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:10] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:10] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:12] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:12] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:12] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:15] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:15] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:15] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:20] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:20] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:20] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:22] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:22] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:22] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:24] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:24] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:24] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:25] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:25] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:25] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:27] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:27] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:27] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:29] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:29] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:29] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:32] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:32] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:32] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:35] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:35] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:35] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:37] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:37] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:37] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:38] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:38] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:38] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:40] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:40] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:40] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:42] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:42] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:42] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:44] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:44] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:44] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:45] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:45] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:45] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:47] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:47] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:47] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:49] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:49] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:49] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:51] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:51] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:51] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:53] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:53] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:53] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:55] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:55] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:55] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:18:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:01] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:01] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:01] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:04] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:04] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:04] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:06] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:06] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:06] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:08] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:08] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:08] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:11] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:11] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:11] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:14] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:16] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:18] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:21] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:21] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:21] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:23] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:23] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:23] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:25] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:25] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:25] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:28] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:28] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:28] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:31] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:31] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:31] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:33] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:35] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:35] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:35] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:38] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:38] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:38] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:41] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:41] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:41] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:44] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:44] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:44] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:46] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:46] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:46] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:49] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:49] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:49] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:51] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:51] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:51] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:54] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:54] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:54] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:56] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:56] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:56] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:19:58] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:20:01] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:20:01] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:20:01] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:20:03] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:20:03] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.
[22:20:03] WARNING: src/c_api/c_api.cc:935: `ntree_limit` is deprecated, use `iteration_range` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the best parameters</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>xgb_train_1<span class="sc">$</span>bestTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   nrounds max_depth eta gamma colsample_bytree min_child_weight subsample
36     200         5 0.3    10              0.3                5       0.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our optimal parameters are:</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="do">## nrounds= 50</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="do">## max_depth = 15</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="do">## eta = 0.5</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="do">## gamma = 10</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="do">## colsample_bytree = 0.3</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="do">## min_child_weight = 5</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="do">## subsample = 0.7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Observations</em>:</p>
<ol type="1">
<li>The following are the optimal parameters we have obtained:</li>
</ol>
<p>nrounds= 50</p>
<p>max_depth = 15</p>
<p>eta = 0.5</p>
<p>gamma = 10</p>
<p>colsample_bytree = 0.3</p>
<p>min_child_weight = 5</p>
<p>subsample = 0.7</p>
<ol start="2" type="1">
<li>One thing to note is that the optimal parameters may change based on the R version and operating system as tested by our group.</li>
</ol>
</section>
<section id="running-the-xgboost-model-with-optimal-parameters" class="level3">
<h3 class="anchored" data-anchor-id="running-the-xgboost-model-with-optimal-parameters">2.1.2 Running the XGBoost model with optimal parameters</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the x and y for train and test sets</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>banks.test3 <span class="ot">&lt;-</span> banks.test <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">big4_auditor =</span> <span class="fu">as.numeric</span>(big4_auditor),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITEM7546 =</span> <span class="fu">as.numeric</span>(ITEM7546))</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>banks.train3_x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(banks.train3  <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(AAER, year)))</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>banks.train3_y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(banks.train3 <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AAER =</span> <span class="fu">as.numeric</span>(AAER) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AAER))</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>banks.test3_x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(banks.test3  <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(AAER, year)))</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>banks.test3_y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(banks.test3 <span class="sc">%&gt;%</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AAER =</span> <span class="fu">as.numeric</span>(AAER) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AAER))</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Why do we need to -1 for the y?</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Because when we convert to numeric factors 0 and 1 become 1 and 2.</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the optimal params</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">max_depth =</span> <span class="dv">15</span>,</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">eta =</span> <span class="fl">0.5</span>,</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">gamma =</span> <span class="dv">10</span>,</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">min_child_weight =</span> <span class="dv">5</span>,</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">colsample_bytree =</span> <span class="fl">0.3</span>,</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">subsample =</span> <span class="fl">0.7</span>,</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">objective=</span> <span class="st">"binary:logistic"</span>)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the model using xgboost not xgb.cv</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>xgb1 <span class="ot">&lt;-</span> <span class="fu">xgboost</span>(<span class="at">params =</span> params,</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> banks.train3_x,</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> banks.train3_y,</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">nrounds =</span> <span class="dv">50</span>,</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">eval_metric =</span> <span class="st">'auc'</span>,</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">nfold =</span> <span class="dv">10</span>, <span class="co">#10 folds cv</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">stratified =</span> <span class="cn">TRUE</span> <span class="co">#use stratified sampling</span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[22:20:05] WARNING: src/learner.cc:767: 
Parameters: { "nfold", "stratified" } are not used.

[1] train-auc:0.704114 
[2] train-auc:0.787830 
[3] train-auc:0.878417 
[4] train-auc:0.882364 
[5] train-auc:0.909341 
[6] train-auc:0.907549 
[7] train-auc:0.922676 
[8] train-auc:0.948476 
[9] train-auc:0.955309 
[10]    train-auc:0.962180 
[11]    train-auc:0.965094 
[12]    train-auc:0.967511 
[13]    train-auc:0.972671 
[14]    train-auc:0.973968 
[15]    train-auc:0.975941 
[16]    train-auc:0.975941 
[17]    train-auc:0.975941 
[18]    train-auc:0.976689 
[19]    train-auc:0.978275 
[20]    train-auc:0.978275 
[21]    train-auc:0.978275 
[22]    train-auc:0.978275 
[23]    train-auc:0.978871 
[24]    train-auc:0.980129 
[25]    train-auc:0.980129 
[26]    train-auc:0.980129 
[27]    train-auc:0.980129 
[28]    train-auc:0.981540 
[29]    train-auc:0.981540 
[30]    train-auc:0.982249 
[31]    train-auc:0.982249 
[32]    train-auc:0.982249 
[33]    train-auc:0.984259 
[34]    train-auc:0.984259 
[35]    train-auc:0.984259 
[36]    train-auc:0.984259 
[37]    train-auc:0.984259 
[38]    train-auc:0.984259 
[39]    train-auc:0.984678 
[40]    train-auc:0.984678 
[41]    train-auc:0.986051 
[42]    train-auc:0.986051 
[43]    train-auc:0.987245 
[44]    train-auc:0.987245 
[45]    train-auc:0.987245 
[46]    train-auc:0.987245 
[47]    train-auc:0.987245 
[48]    train-auc:0.987245 
[49]    train-auc:0.987245 
[50]    train-auc:0.987245 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># precision: ratio of true positives to total predicted positives</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># recall: ratio of true negative to total predicted negatives</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># true positives(tp) / sensitivity : tp/tp+fn</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># true negatives(tn) / specificity : tn/tn+fp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Observations</em>:</p>
<ol type="1">
<li>We obtained a train AUC above 0.95.</li>
<li>This result is suspicious and could indicate that our model has over-fitted to the training data.One limitation would be that AAER displayed an imbalanced data (in favour of the “0” prediction), high recall, and low precision. That is, you’re predicting most of the ones at the higher end of your prediction probabilities, but most of the outcomes at the higher end of your prediction probabilities are still zero. In short, there could be high AUC but also high misclassification error.</li>
</ol>
</section>
<section id="ranking-important-variables" class="level3">
<h3 class="anchored" data-anchor-id="ranking-important-variables">2.1.3 Ranking Important Variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get column names from banks.train3_x</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(<span class="fu">as.matrix</span>(banks.train3_x))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate variable importance</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">xgb.importance</span>(col_names, <span class="at">model =</span> xgb1)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot variable importance</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">xgb.plot.importance</span>(<span class="at">importance_matrix =</span> imp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Observations</em>:</p>
<ol type="1">
<li><p>Significant variables include:</p>
<p>ITEM 8236: Total Debt % Total Assets</p>
<p>ITEM 9104: Price/Earnings Ratio</p>
<p>ITEM 3998: Total Capital</p>
<p>ITEM 9304: Price/Book Value Ratio</p></li>
</ol>
<!-- -->
<ol start="2" type="1">
<li>Even though we are not using this model, it could be a good indicator that these variables are more effective at determining account manipulation if the significant variables match with those in other models in the future.</li>
</ol>
</section>
<section id="plotting-roc" class="level3">
<h3 class="anchored" data-anchor-id="plotting-roc">2.1.4 Plotting ROC</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert labels to binary format (if needed)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: If your target variable is already in binary format, you can skip this step</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>labels_train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(banks.train3_y <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>labels_test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(banks.test3_y <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>pred_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb1, banks.test3_x, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for test predictions and actual labels</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>df_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pred.xgb =</span> pred_test, <span class="at">AAER =</span> <span class="fu">factor</span>(labels_test, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the training data</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>pred_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb1, banks.train3_x, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for training predictions and actual labels</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>df_train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pred.xgb =</span> pred_train, <span class="at">AAER =</span> <span class="fu">factor</span>(labels_train, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate AUC for both training and testing data</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>auc_in_xgb <span class="ot">&lt;-</span> df_train <span class="sc">%&gt;%</span> <span class="fu">roc_auc</span>(AAER, pred.xgb, <span class="at">event_level=</span><span class="st">'second'</span>) </span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>auc_out_xgb <span class="ot">&lt;-</span> df_test <span class="sc">%&gt;%</span> <span class="fu">roc_auc</span>(AAER, pred.xgb, <span class="at">event_level=</span><span class="st">'second'</span>) </span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>curve_in_xgb <span class="ot">&lt;-</span> df_train <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER, pred.xgb, <span class="at">event_level=</span><span class="st">'second'</span>) </span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>curve_out_xgb <span class="ot">&lt;-</span> df_test <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER, pred.xgb, <span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>aucs_xgb <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"In sample, XGBoost"</span> <span class="ot">=</span> auc_in_xgb, <span class="st">"Out of sample, XGBoost"</span> <span class="ot">=</span> auc_out_xgb)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Print AUC values</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"In-sample AUC:"</span>, auc_in_xgb)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "In-sample AUC: roc_auc"           "In-sample AUC: binary"           
[3] "In-sample AUC: 0.987244800789287"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Out-of-sample AUC:"</span>, auc_out_xgb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Out-of-sample AUC: roc_auc"          
[2] "Out-of-sample AUC: binary"           
[3] "Out-of-sample AUC: 0.948056730486523"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC curves</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="at">data=</span>curve_out_xgb, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity, <span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color=</span><span class="st">"XGBoost out of sample"</span>)) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="at">data=</span>curve_in_xgb, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity, <span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color=</span><span class="st">"XGBoost in sample"</span>)) <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming aucs_xgb is a vector containing the XGBoost AUC value</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>oos_aucs <span class="ot">&lt;-</span> aucs_xgb</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assigning a name to the AUC value</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(oos_aucs) <span class="ot">&lt;-</span> <span class="st">"XGBoost"</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the AUC value</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>oos_aucs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$XGBoost
[1] "roc_auc"

$&lt;NA&gt;
[1] "binary"

$&lt;NA&gt;
[1] 0.9872448

$&lt;NA&gt;
[1] "roc_auc"

$&lt;NA&gt;
[1] "binary"

$&lt;NA&gt;
[1] 0.9480567</code></pre>
</div>
</div>
<p><em>Observations</em>:</p>
<p>Surprisingly, our test AUC is not too far off from our train AUC.</p>
<p>In Sample AUC (Train) = 0.9850</p>
<p>Out of Sample AUC (Test) = 0.9283</p>
</section>
<section id="confusion-matrix" class="level3">
<h3 class="anchored" data-anchor-id="confusion-matrix">2.1.5 Confusion Matrix</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate Final Model</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>pred.xgb1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(xgb1, banks.test3_x, <span class="at">type=</span><span class="st">'response'</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>confmat.xgb1 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">factor</span>(<span class="fu">ifelse</span>(pred.xgb1<span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)), banks.test3<span class="sc">$</span>AAER)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>confmat.xgb1</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the Misclassification Error</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># fp+fn/(fp+fn+tp+tn)</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>missclass.xgb <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (confmat.xgb1[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.xgb1[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.xgb1[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.xgb1[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmat.xgb1[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.xgb1[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the sensitivity and precision</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>sensitivity.xgb <span class="ot">&lt;-</span> confmat.xgb1[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(confmat.xgb1[,<span class="dv">2</span>])</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the precision</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>precision.xgb <span class="ot">&lt;-</span> confmat.xgb1[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(confmat.xgb1[<span class="dv">2</span>,])</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>missclass.xgb </span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>sensitivity.xgb</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>precision.xgb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Observations</em>:</p>
<ol type="1">
<li>Surprisingly, our total misclassification error is only 0.01173. However, this can be deceiving since there is an overwhelming number of AAER = “0” in our dataset.</li>
<li>Our sensitivity is under 0.4, which indicates that this model may not be good at classifying positives from negatives.</li>
<li>Our precision of &gt;0.90 is too suspicious to accept as well.</li>
<li>Hence, we decided to explore logistic regression and lasso models.</li>
</ol>
</section>
</section>
<section id="logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="logistic-regression">2.2 Logistic Regression</h2>
<ol type="1">
<li><p>Initially, we ran 6 logistic regression models - removing a variable that was highly correlated to prevent multicollinearity</p></li>
<li><p>Thereafter, we used AIC to compare the models since AIC quantifies the trade-off between how well a model fits the data and how complex it is. The lower the AIC, the better the model is.</p></li>
<li><p>We realised that models 2 and 4 had an extremely close AIC of 1968.9 and 1968.2 respectively.</p></li>
</ol>
<section id="log-reg-1" class="level3">
<h3 class="anchored" data-anchor-id="log-reg-1">2.2.1 Log Reg 1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>log.fit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(AAER<span class="sc">~</span>. <span class="sc">-</span>year<span class="sc">-</span>ITEM3998, <span class="at">data=</span>banks.train, <span class="at">family=</span>binomial)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.fit1) <span class="co">#AIC = 1975</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = AAER ~ . - year - ITEM3998, family = binomial, 
    data = banks.train)

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -7.901073   1.083211  -7.294 3.01e-13 ***
ITEM7240                      -0.005832   0.066988  -0.087 0.930621    
ITEM8236                      -0.309639   0.081797  -3.785 0.000153 ***
ITEM8301                      -0.007605   0.095680  -0.079 0.936644    
ITEM3255                      -0.037194   0.056010  -0.664 0.506658    
ITEM3999                       0.150360   0.068424   2.197 0.027986 *  
ITEM8231                       0.454660   0.130524   3.483 0.000495 ***
ITEM8381                       0.318692   0.107918   2.953 0.003146 ** 
ITEM8311                      -0.084496   0.117390  -0.720 0.471657    
ITEM8316                      -0.092149   0.117399  -0.785 0.432502    
ITEM8906                       0.114164   0.065972   1.730 0.083542 .  
ITEM8361                      -0.274721   0.098289  -2.795 0.005189 ** 
ITEM15025                      0.392085   0.066418   5.903 3.56e-09 ***
ITEM15061                     -0.019985   0.081581  -0.245 0.806479    
ITEM15073                     -0.134711   0.137203  -0.982 0.326179    
ITEM15156                      0.324577   0.142068   2.285 0.022333 *  
ITEM15173                      0.453481   0.115192   3.937 8.26e-05 ***
ITEM75465                    -13.770328 335.580663  -0.041 0.967269    
ITEM75466                     -1.758854   0.176860  -9.945  &lt; 2e-16 ***
ITEM75467                    -14.061729 582.408841  -0.024 0.980738    
ITEM9104                      -0.405284   0.051242  -7.909 2.59e-15 ***
ITEM9304                       0.334541   0.074700   4.478 7.52e-06 ***
ITEM18156                     -0.056956   0.033999  -1.675 0.093893 .  
ITEM3995                      -0.059807   0.076576  -0.781 0.434790    
ITEM2004                       0.038322   0.030007   1.277 0.201573    
ITEM3019                      -0.086013   0.035329  -2.435 0.014905 *  
big4_auditor1                  1.694858   0.225153   7.528 5.17e-14 ***
leverage_ratio                -0.208961   0.135302  -1.544 0.122491    
total_capital_adequacy_ratio   0.412307   0.179886   2.292 0.021903 *  
net_profit_margin             -0.029534   0.056055  -0.527 0.598278    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2419.1  on 13530  degrees of freedom
Residual deviance: 1915.0  on 13501  degrees of freedom
AIC: 1975

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a confusion matrix</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default cut off point to classify the default as 0.5</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use model to predict probability of default</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then get test accuracy</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>predicted1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(log.fit1, banks.test, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(predicted1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5799</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>confmat.test1 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.factor</span>(<span class="fu">ifelse</span>(predicted1<span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)),banks.test<span class="sc">$</span>AAER)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>confmat.test1 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 5676  113
  1    2    8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>accuracy1 <span class="ot">&lt;-</span> (confmat.test1[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test1[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.test1[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test1[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmat.test1[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test1[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>accuracy1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.980169</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Accuracy: 98.02% </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="log-reg-2---no-item-3255" class="level3">
<h3 class="anchored" data-anchor-id="log-reg-2---no-item-3255">2.2.2 Log Reg 2 - No Item 3255</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>log.fit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(AAER<span class="sc">~</span>. <span class="sc">-</span>year<span class="sc">-</span>ITEM3255, <span class="at">data=</span>banks.train, <span class="at">family=</span>binomial)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.fit2) <span class="co">#AIC = 1968.9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = AAER ~ . - year - ITEM3255, family = binomial, 
    data = banks.train)

Coefficients:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -7.73829    1.08125  -7.157 8.26e-13 ***
ITEM7240                      -0.05044    0.06787  -0.743  0.45736    
ITEM8236                      -0.31694    0.07974  -3.975 7.05e-05 ***
ITEM8301                      -0.02491    0.09538  -0.261  0.79396    
ITEM3999                       0.10223    0.06579   1.554  0.12024    
ITEM8231                       0.39673    0.13424   2.955  0.00312 ** 
ITEM8381                       0.29972    0.10694   2.803  0.00507 ** 
ITEM8311                      -0.08240    0.11559  -0.713  0.47593    
ITEM8316                      -0.11988    0.11629  -1.031  0.30261    
ITEM8906                       0.11392    0.06614   1.722  0.08500 .  
ITEM8361                      -0.21779    0.10014  -2.175  0.02965 *  
ITEM15025                      0.36159    0.06739   5.366 8.06e-08 ***
ITEM15061                     -0.03492    0.08147  -0.429  0.66816    
ITEM15073                     -0.14366    0.13716  -1.047  0.29492    
ITEM15156                      0.36600    0.14400   2.542  0.01103 *  
ITEM15173                      0.49132    0.11487   4.277 1.89e-05 ***
ITEM75465                    -13.75955  336.17764  -0.041  0.96735    
ITEM75466                     -1.76541    0.17728  -9.958  &lt; 2e-16 ***
ITEM75467                    -14.07617  582.14677  -0.024  0.98071    
ITEM9104                      -0.39782    0.05128  -7.757 8.67e-15 ***
ITEM9304                       0.31942    0.07495   4.262 2.03e-05 ***
ITEM3998                       0.21731    0.08392   2.589  0.00961 ** 
ITEM18156                     -0.06024    0.03392  -1.776  0.07574 .  
ITEM3995                      -0.20081    0.09181  -2.187  0.02873 *  
ITEM2004                       0.03587    0.02976   1.205  0.22810    
ITEM3019                      -0.08982    0.03504  -2.563  0.01038 *  
big4_auditor1                  1.65393    0.22612   7.314 2.59e-13 ***
leverage_ratio                -0.21571    0.13617  -1.584  0.11317    
total_capital_adequacy_ratio   0.43198    0.18165   2.378  0.01740 *  
net_profit_margin             -0.03299    0.05491  -0.601  0.54799    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2419.1  on 13530  degrees of freedom
Residual deviance: 1908.9  on 13501  degrees of freedom
AIC: 1968.9

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a confusion matrix</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default cut off point to classify the default as 0.5</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use model to predict probability of AAER</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get test accuracy</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>predicted2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(log.fit2, banks.test, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>confmat.test2 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.factor</span>(<span class="fu">ifelse</span>(predicted2<span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)),banks.test<span class="sc">$</span>AAER)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>confmat.test2 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 5677  115
  1    1    6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the test accuracy</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># TP+TN/(TP+TN+FP+FN)</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>accuracy2 <span class="ot">&lt;-</span> (confmat.test2[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test2[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.test2[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test2[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmat.test2[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test2[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>accuracy2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9799966</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Accuracy: 98.00%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="log-reg-3---no-item-8361" class="level3">
<h3 class="anchored" data-anchor-id="log-reg-3---no-item-8361">2.2.3 Log Reg 3 - No Item 8361</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>log.fit3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(AAER<span class="sc">~</span>. <span class="sc">-</span>year<span class="sc">-</span>ITEM8361, <span class="at">data=</span>banks.train, <span class="at">family=</span>binomial)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.fit3) <span class="co">#AIC = 1973.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = AAER ~ . - year - ITEM8361, family = binomial, 
    data = banks.train)

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -7.973212   1.082741  -7.364 1.79e-13 ***
ITEM7240                      -0.066060   0.066075  -1.000 0.317415    
ITEM8236                      -0.289563   0.082258  -3.520 0.000431 ***
ITEM8301                      -0.065402   0.093516  -0.699 0.484319    
ITEM3255                      -0.044961   0.058527  -0.768 0.442364    
ITEM3999                       0.132306   0.069165   1.913 0.055761 .  
ITEM8231                       0.413406   0.131979   3.132 0.001734 ** 
ITEM8381                       0.218392   0.099646   2.192 0.028402 *  
ITEM8311                       0.002833   0.105999   0.027 0.978677    
ITEM8316                      -0.242252   0.101046  -2.397 0.016510 *  
ITEM8906                       0.127311   0.065943   1.931 0.053530 .  
ITEM15025                      0.394056   0.065726   5.995 2.03e-09 ***
ITEM15061                     -0.029714   0.081618  -0.364 0.715815    
ITEM15073                     -0.172114   0.136936  -1.257 0.208793    
ITEM15156                      0.411225   0.145477   2.827 0.004702 ** 
ITEM15173                      0.471424   0.115410   4.085 4.41e-05 ***
ITEM75465                    -13.814174 334.815706  -0.041 0.967089    
ITEM75466                     -1.782332   0.177377 -10.048  &lt; 2e-16 ***
ITEM75467                    -14.072922 581.737262  -0.024 0.980700    
ITEM9104                      -0.400384   0.051481  -7.777 7.40e-15 ***
ITEM9304                       0.322378   0.075192   4.287 1.81e-05 ***
ITEM3998                       0.262371   0.082963   3.163 0.001564 ** 
ITEM18156                     -0.055920   0.033841  -1.652 0.098450 .  
ITEM3995                      -0.221110   0.089869  -2.460 0.013880 *  
ITEM2004                       0.033658   0.029769   1.131 0.258211    
ITEM3019                      -0.085778   0.035283  -2.431 0.015052 *  
big4_auditor1                  1.669259   0.224584   7.433 1.06e-13 ***
leverage_ratio                -0.169005   0.137019  -1.233 0.217410    
total_capital_adequacy_ratio   0.404711   0.178136   2.272 0.023091 *  
net_profit_margin             -0.040112   0.053969  -0.743 0.457335    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2419.1  on 13530  degrees of freedom
Residual deviance: 1913.1  on 13501  degrees of freedom
AIC: 1973.1

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a confusion matrix</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default cut off point to classify the default as 0.5</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use model to predict probability of AAER</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get test accuracy</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>predicted3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(log.fit3, banks.test, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>confmat.test3 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.factor</span>(<span class="fu">ifelse</span>(predicted3<span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)),banks.test<span class="sc">$</span>AAER)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>confmat.test3 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 5675  110
  1    3   11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>accuracy3 <span class="ot">&lt;-</span> (confmat.test3[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test3[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.test3[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test3[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmat.test3[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test3[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>accuracy3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9805139</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Accuracy: 98.05%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="log-reg-4---no-item-8301" class="level3">
<h3 class="anchored" data-anchor-id="log-reg-4---no-item-8301">2.2.4 Log Reg 4 - No Item 8301</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>log.fit4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(AAER<span class="sc">~</span>. <span class="sc">-</span>year<span class="sc">-</span>ITEM8301, <span class="at">data=</span>banks.train, <span class="at">family=</span>binomial)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.fit4) <span class="co">#AIC = 1968.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = AAER ~ . - year - ITEM8301, family = binomial, 
    data = banks.train)

Coefficients:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -7.83709    1.08741  -7.207 5.71e-13 ***
ITEM7240                      -0.04402    0.06727  -0.654 0.512856    
ITEM8236                      -0.30395    0.08162  -3.724 0.000196 ***
ITEM3255                      -0.05021    0.05808  -0.865 0.387287    
ITEM3999                       0.12180    0.06988   1.743 0.081327 .  
ITEM8231                       0.40388    0.13384   3.018 0.002547 ** 
ITEM8381                       0.28536    0.10341   2.759 0.005790 ** 
ITEM8311                      -0.07367    0.11422  -0.645 0.518939    
ITEM8316                      -0.12536    0.11213  -1.118 0.263581    
ITEM8906                       0.11351    0.06609   1.718 0.085862 .  
ITEM8361                      -0.22555    0.09802  -2.301 0.021380 *  
ITEM15025                      0.36390    0.06728   5.409 6.36e-08 ***
ITEM15061                     -0.03379    0.08140  -0.415 0.678082    
ITEM15073                     -0.13687    0.13772  -0.994 0.320336    
ITEM15156                      0.35871    0.14402   2.491 0.012751 *  
ITEM15173                      0.48930    0.11501   4.254 2.10e-05 ***
ITEM75465                    -13.75974  336.16154  -0.041 0.967350    
ITEM75466                     -1.76340    0.17702  -9.962  &lt; 2e-16 ***
ITEM75467                    -14.06766  582.16584  -0.024 0.980722    
ITEM9104                      -0.39875    0.05119  -7.789 6.75e-15 ***
ITEM9304                       0.31495    0.07446   4.230 2.34e-05 ***
ITEM3998                       0.22350    0.08501   2.629 0.008564 ** 
ITEM18156                     -0.05932    0.03396  -1.746 0.080733 .  
ITEM3995                      -0.18967    0.09011  -2.105 0.035308 *  
ITEM2004                       0.03773    0.02987   1.263 0.206602    
ITEM3019                      -0.08915    0.03512  -2.538 0.011140 *  
big4_auditor1                  1.66088    0.22577   7.357 1.89e-13 ***
leverage_ratio                -0.19318    0.13777  -1.402 0.160838    
total_capital_adequacy_ratio   0.42888    0.18136   2.365 0.018038 *  
net_profit_margin             -0.03267    0.05337  -0.612 0.540382    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2419.1  on 13530  degrees of freedom
Residual deviance: 1908.2  on 13501  degrees of freedom
AIC: 1968.2

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>log.fit4<span class="sc">$</span>aic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1968.208</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a confusion matrix</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default cut off point to classify the default as 0.5</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use model to predict probability of AAER</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get test accuracy</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>predicted4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(log.fit4, banks.test, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>confmat.test4 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.factor</span>(<span class="fu">ifelse</span>(predicted4<span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)),banks.test<span class="sc">$</span>AAER)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>confmat.test4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 5677  115
  1    1    6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>accuracy4 <span class="ot">&lt;-</span> (confmat.test4[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.test4[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmat.test4[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>accuracy4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9799966</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Accuracy: 98.00%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="log-reg-5---no-item-18156" class="level3">
<h3 class="anchored" data-anchor-id="log-reg-5---no-item-18156">2.2.5 Log Reg 5 - No Item 18156</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>log.fit5 <span class="ot">&lt;-</span> <span class="fu">glm</span>(AAER<span class="sc">~</span>. <span class="sc">-</span>year<span class="sc">-</span>ITEM18156, <span class="at">data=</span>banks.train, <span class="at">family=</span>binomial)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.fit5) <span class="co">#AIC = 1971.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = AAER ~ . - year - ITEM18156, family = binomial, 
    data = banks.train)

Coefficients:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -8.13921    1.07358  -7.581 3.42e-14 ***
ITEM7240                      -0.04798    0.06711  -0.715 0.474632    
ITEM8236                      -0.29659    0.08140  -3.643 0.000269 ***
ITEM8301                      -0.03049    0.09523  -0.320 0.748795    
ITEM3255                      -0.05446    0.05800  -0.939 0.347772    
ITEM3999                       0.12708    0.06977   1.822 0.068521 .  
ITEM8231                       0.38380    0.13204   2.907 0.003652 ** 
ITEM8381                       0.29845    0.10761   2.773 0.005546 ** 
ITEM8311                      -0.08595    0.11625  -0.739 0.459700    
ITEM8316                      -0.12428    0.11555  -1.076 0.282103    
ITEM8906                       0.11508    0.06582   1.749 0.080363 .  
ITEM8361                      -0.21390    0.09959  -2.148 0.031728 *  
ITEM15025                      0.36343    0.06743   5.390 7.05e-08 ***
ITEM15061                     -0.04243    0.08152  -0.521 0.602712    
ITEM15073                     -0.13180    0.13714  -0.961 0.336528    
ITEM15156                      0.36192    0.14342   2.523 0.011622 *  
ITEM15173                      0.49532    0.11480   4.314 1.60e-05 ***
ITEM75465                    -13.77903  335.14745  -0.041 0.967206    
ITEM75466                     -1.75479    0.17744  -9.889  &lt; 2e-16 ***
ITEM75467                    -14.11677  583.19240  -0.024 0.980688    
ITEM9104                      -0.39587    0.05099  -7.764 8.25e-15 ***
ITEM9304                       0.31188    0.07459   4.181 2.90e-05 ***
ITEM3998                       0.22146    0.08523   2.598 0.009367 ** 
ITEM3995                      -0.19904    0.09314  -2.137 0.032597 *  
ITEM2004                       0.03410    0.02966   1.150 0.250245    
ITEM3019                      -0.09301    0.03491  -2.664 0.007712 ** 
big4_auditor1                  1.64585    0.22600   7.282 3.28e-13 ***
leverage_ratio                -0.17730    0.13624  -1.301 0.193109    
total_capital_adequacy_ratio   0.43325    0.18856   2.298 0.021580 *  
net_profit_margin             -0.03454    0.05499  -0.628 0.529929    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2419.1  on 13530  degrees of freedom
Residual deviance: 1911.1  on 13501  degrees of freedom
AIC: 1971.1

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a confusion matrix</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default cut off point to classify the default as 0.5</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use model to predict probability of AAER</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get test accuracy</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>predicted5 <span class="ot">&lt;-</span> <span class="fu">predict</span>(log.fit5, banks.test, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>confmat.test5 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.factor</span>(<span class="fu">ifelse</span>(predicted5<span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)),banks.test<span class="sc">$</span>AAER)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>confmat.test5 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 5676  115
  1    2    6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>accuracy5 <span class="ot">&lt;-</span> (confmat.test5[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test5[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.test5[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test5[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmat.test5[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test5[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>accuracy5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9798241</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Accuracy: 97.98%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="log-reg-6---no-item-3995" class="level3">
<h3 class="anchored" data-anchor-id="log-reg-6---no-item-3995">2.2.6 Log Reg 6 - No Item 3995</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>log.fit6 <span class="ot">&lt;-</span> <span class="fu">glm</span>(AAER<span class="sc">~</span>. <span class="sc">-</span>year<span class="sc">-</span>ITEM3995, <span class="at">data=</span>banks.train, <span class="at">family=</span>binomial)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.fit6) <span class="co">#AIC = 1972.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = AAER ~ . - year - ITEM3995, family = binomial, 
    data = banks.train)

Coefficients:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -7.82659    1.08737  -7.198 6.12e-13 ***
ITEM7240                      -0.07262    0.06624  -1.096  0.27290    
ITEM8236                      -0.33655    0.07937  -4.240 2.23e-05 ***
ITEM8301                       0.02764    0.09354   0.296  0.76761    
ITEM3255                      -0.05861    0.05689  -1.030  0.30290    
ITEM3999                       0.08739    0.06689   1.307  0.19137    
ITEM8231                       0.42092    0.13362   3.150  0.00163 ** 
ITEM8381                       0.32845    0.10846   3.028  0.00246 ** 
ITEM8311                      -0.11052    0.11757  -0.940  0.34716    
ITEM8316                      -0.10464    0.11810  -0.886  0.37560    
ITEM8906                       0.11085    0.06605   1.678  0.09330 .  
ITEM8361                      -0.25548    0.10032  -2.547  0.01088 *  
ITEM15025                      0.37129    0.06723   5.523 3.34e-08 ***
ITEM15061                     -0.02707    0.08165  -0.331  0.74028    
ITEM15073                     -0.14931    0.13751  -1.086  0.27755    
ITEM15156                      0.35329    0.14314   2.468  0.01358 *  
ITEM15173                      0.49120    0.11566   4.247 2.17e-05 ***
ITEM75465                    -13.76039  336.43753  -0.041  0.96738    
ITEM75466                     -1.78112    0.17646 -10.094  &lt; 2e-16 ***
ITEM75467                    -14.09210  582.06041  -0.024  0.98068    
ITEM9104                      -0.39928    0.05143  -7.764 8.24e-15 ***
ITEM9304                       0.33247    0.07495   4.436 9.18e-06 ***
ITEM3998                       0.12544    0.07179   1.747  0.08058 .  
ITEM18156                     -0.05987    0.03391  -1.765  0.07751 .  
ITEM2004                       0.03645    0.02982   1.222  0.22154    
ITEM3019                      -0.08742    0.03513  -2.489  0.01283 *  
big4_auditor1                  1.67283    0.22595   7.403 1.33e-13 ***
leverage_ratio                -0.15000    0.13596  -1.103  0.26990    
total_capital_adequacy_ratio   0.41556    0.17943   2.316  0.02056 *  
net_profit_margin             -0.05372    0.05447  -0.986  0.32402    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2419.1  on 13530  degrees of freedom
Residual deviance: 1912.6  on 13501  degrees of freedom
AIC: 1972.6

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a confusion matrix</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default cut off point to classify the default as 0.5</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use model to predict probability of AAER</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get test accuracy</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>predicted6 <span class="ot">&lt;-</span> <span class="fu">predict</span>(log.fit6, banks.test, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>confmat.test6 <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.factor</span>(<span class="fu">ifelse</span>(predicted6<span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)),banks.test<span class="sc">$</span>AAER)</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>confmat.test6 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 5677  115
  1    1    6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>accuracy6 <span class="ot">&lt;-</span> (confmat.test6[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test6[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.test6[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test6[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmat.test6[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test6[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>accuracy6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9799966</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Accuracy: 98.00%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="measureables-of-the-6-log-reg-models-in-a-table-for-easier-comparison" class="level3">
<h3 class="anchored" data-anchor-id="measureables-of-the-6-log-reg-models-in-a-table-for-easier-comparison">2.2.7 Measureables of the 6 Log Reg Models in a table for easier comparison</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>aics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"log_model"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"log.fit1"</span>,<span class="st">"log.fit2"</span>,<span class="st">"log.fit3"</span>,<span class="st">"log.fit4"</span>,<span class="st">"log.fit5"</span>,<span class="st">"log.fit6"</span>),</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"AIC"</span> <span class="ot">=</span> <span class="fu">c</span>(log.fit1<span class="sc">$</span>aic, log.fit2<span class="sc">$</span>aic, log.fit3<span class="sc">$</span>aic,log.fit4<span class="sc">$</span>aic,log.fit5<span class="sc">$</span>aic,log.fit6<span class="sc">$</span>aic),</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Accuracy"</span> <span class="ot">=</span> <span class="fu">c</span>(accuracy1,accuracy2,accuracy3,accuracy4,accuracy5,accuracy6))</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>aics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  log_model      AIC  Accuracy
1  log.fit1 1975.000 0.9801690
2  log.fit2 1968.893 0.9799966
3  log.fit3 1973.075 0.9805139
4  log.fit4 1968.208 0.9799966
5  log.fit5 1971.095 0.9798241
6  log.fit6 1972.574 0.9799966</code></pre>
</div>
</div>
<p><em>Observations</em>:</p>
<ol type="1">
<li>All the models have approximately the same classification accuracy of 98%.</li>
</ol>
<!-- -->
<ol start="2" type="1">
<li><p>We realised that models 2 and 4 have the lowest AIC that was extremely close at 1968.9 and 1968.2 respectively.</p></li>
<li><p>Therefore, we proceed to the next step for each model; removing a statistically insignificant variable with each iteration.</p></li>
<li><p>This gives us the following 5 new models.</p></li>
</ol>
</section>
<section id="log-reg-2.1" class="level3">
<h3 class="anchored" data-anchor-id="log-reg-2.1">2.2.8 Log Reg 2.1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuation of Log Reg 2</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>log.fit2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(AAER<span class="sc">~</span>. <span class="sc">-</span>year<span class="sc">-</span>ITEM7240<span class="sc">-</span>ITEM8301<span class="sc">-</span>ITEM8311<span class="sc">-</span>ITEM8316<span class="sc">-</span>ITEM8906<span class="sc">-</span>ITEM8361<span class="sc">-</span>ITEM15061<span class="sc">-</span>ITEM15073<span class="sc">-</span>ITEM18156<span class="sc">-</span>leverage_ratio<span class="sc">-</span>ITEM3995<span class="sc">-</span>ITEM2004, <span class="at">data=</span>banks.train, <span class="at">family=</span>binomial)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.fit2<span class="fl">.1</span>) <span class="co">#AIC = 1976.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = AAER ~ . - year - ITEM7240 - ITEM8301 - ITEM8311 - 
    ITEM8316 - ITEM8906 - ITEM8361 - ITEM15061 - ITEM15073 - 
    ITEM18156 - leverage_ratio - ITEM3995 - ITEM2004, family = binomial, 
    data = banks.train)

Coefficients:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -8.27948    0.78560 -10.539  &lt; 2e-16 ***
ITEM8236                      -0.33737    0.07635  -4.418 9.94e-06 ***
ITEM3255                      -0.07871    0.05591  -1.408   0.1592    
ITEM3999                       0.07201    0.06680   1.078   0.2810    
ITEM8231                       0.37427    0.07483   5.002 5.68e-07 ***
ITEM8381                       0.15479    0.07463   2.074   0.0381 *  
ITEM15025                      0.43439    0.06331   6.861 6.83e-12 ***
ITEM15156                      0.32139    0.12492   2.573   0.0101 *  
ITEM15173                      0.49363    0.11234   4.394 1.11e-05 ***
ITEM75465                    -14.06724  332.62039  -0.042   0.9663    
ITEM75466                     -1.87508    0.16900 -11.095  &lt; 2e-16 ***
ITEM75467                    -14.15530  580.77817  -0.024   0.9806    
ITEM9104                      -0.39312    0.05159  -7.620 2.55e-14 ***
ITEM9304                       0.32283    0.07420   4.351 1.36e-05 ***
ITEM3998                       0.12706    0.06631   1.916   0.0553 .  
ITEM3019                      -0.08435    0.03425  -2.463   0.0138 *  
big4_auditor1                  1.66699    0.21988   7.581 3.42e-14 ***
total_capital_adequacy_ratio   0.38533    0.18269   2.109   0.0349 *  
net_profit_margin             -0.11651    0.05197  -2.242   0.0250 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2419.1  on 13530  degrees of freedom
Residual deviance: 1938.3  on 13512  degrees of freedom
AIC: 1976.3

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a confusion matrix</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default cut off point to classify the default as 0.5</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use model to predict probability of AAER</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get test accuracy</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>predicted2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">predict</span>(log.fit2<span class="fl">.1</span>, banks.test, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>confmat.test2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.factor</span>(<span class="fu">ifelse</span>(predicted2<span class="fl">.1</span><span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="st">"1"</span>,<span class="st">"0"</span>)),banks.test<span class="sc">$</span>AAER)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>confmat.test2<span class="fl">.1</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 5678  114
  1    0    7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> (confmat.test2<span class="fl">.1</span>[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test2<span class="fl">.1</span>[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.test2<span class="fl">.1</span>[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test2<span class="fl">.1</span>[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmat.test2<span class="fl">.1</span>[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test2<span class="fl">.1</span>[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9803414</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Accuracy: 98.03%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="log-reg-2.2" class="level3">
<h3 class="anchored" data-anchor-id="log-reg-2.2">2.2.9 Log Reg 2.2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuation of Log Reg 2</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>log.fit2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(AAER<span class="sc">~</span>. <span class="sc">-</span>year<span class="sc">-</span>ITEM7240<span class="sc">-</span>ITEM8301<span class="sc">-</span>ITEM8311<span class="sc">-</span>ITEM8316<span class="sc">-</span>ITEM8906<span class="sc">-</span>ITEM8361<span class="sc">-</span>ITEM15061<span class="sc">-</span>ITEM15073<span class="sc">-</span>ITEM18156<span class="sc">-</span>leverage_ratio<span class="sc">-</span>ITEM3995<span class="sc">-</span>ITEM2004<span class="sc">-</span>ITEM8381<span class="sc">-</span>ITEM3998<span class="sc">-</span>ITEM3255, <span class="at">data=</span>banks.train, <span class="at">family=</span>binomial)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.fit2<span class="fl">.2</span>) <span class="co">#AIC = 1979.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = AAER ~ . - year - ITEM7240 - ITEM8301 - ITEM8311 - 
    ITEM8316 - ITEM8906 - ITEM8361 - ITEM15061 - ITEM15073 - 
    ITEM18156 - leverage_ratio - ITEM3995 - ITEM2004 - ITEM8381 - 
    ITEM3998 - ITEM3255, family = binomial, data = banks.train)

Coefficients:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -7.98499    0.76399 -10.452  &lt; 2e-16 ***
ITEM8236                      -0.36317    0.07192  -5.049 4.43e-07 ***
ITEM3999                       0.10220    0.04771   2.142  0.03219 *  
ITEM8231                       0.37573    0.06684   5.622 1.89e-08 ***
ITEM15025                      0.44311    0.06074   7.295 2.98e-13 ***
ITEM15156                      0.33434    0.12393   2.698  0.00698 ** 
ITEM15173                      0.52509    0.10983   4.781 1.75e-06 ***
ITEM75465                    -14.02884  333.00977  -0.042  0.96640    
ITEM75466                     -1.86405    0.16719 -11.149  &lt; 2e-16 ***
ITEM75467                    -14.19227  580.47047  -0.024  0.98049    
ITEM9104                      -0.39743    0.05123  -7.758 8.64e-15 ***
ITEM9304                       0.38320    0.07128   5.376 7.61e-08 ***
ITEM3019                      -0.08046    0.03421  -2.352  0.01866 *  
big4_auditor1                  1.70352    0.21806   7.812 5.62e-15 ***
total_capital_adequacy_ratio   0.41033    0.18538   2.213  0.02687 *  
net_profit_margin             -0.10306    0.04848  -2.126  0.03350 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2419.1  on 13530  degrees of freedom
Residual deviance: 1947.4  on 13515  degrees of freedom
AIC: 1979.4

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a confusion matrix</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default cut off point to classify the default as 0.5</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use model to predict probability of AAER</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get test accuracy</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>predicted2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">predict</span>(log.fit2<span class="fl">.2</span>, banks.test, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>confmat.test2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.factor</span>(<span class="fu">ifelse</span>(predicted2<span class="fl">.2</span><span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="st">"1"</span>,<span class="st">"0"</span>)),banks.test<span class="sc">$</span>AAER)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>confmat.test2<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 5677  114
  1    1    7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> (confmat.test2<span class="fl">.2</span>[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test2<span class="fl">.2</span>[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.test2<span class="fl">.2</span>[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test2<span class="fl">.2</span>[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmat.test2<span class="fl">.2</span>[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test2<span class="fl">.2</span>[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.980169</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Accuracy:98.02%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="log-reg-4.1" class="level3">
<h3 class="anchored" data-anchor-id="log-reg-4.1">2.2.10 Log Reg 4.1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuation of Log Reg 4</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>log.fit4<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(AAER<span class="sc">~</span>. <span class="sc">-</span>year<span class="sc">-</span>ITEM8301<span class="sc">-</span>ITEM8236<span class="sc">-</span>ITEM8231<span class="sc">-</span>ITEM8311<span class="sc">-</span>ITEM8316<span class="sc">-</span>ITEM8906<span class="sc">-</span>ITEM8361<span class="sc">-</span>ITEM15061<span class="sc">-</span>ITEM15073<span class="sc">-</span>ITEM15156<span class="sc">-</span>ITEM18156<span class="sc">-</span>leverage_ratio<span class="sc">-</span>net_profit_margin, <span class="at">data=</span>banks.train, <span class="at">family=</span>binomial)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.fit4<span class="fl">.1</span>) <span class="co">#AIC = 1999.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = AAER ~ . - year - ITEM8301 - ITEM8236 - ITEM8231 - 
    ITEM8311 - ITEM8316 - ITEM8906 - ITEM8361 - ITEM15061 - ITEM15073 - 
    ITEM15156 - ITEM18156 - leverage_ratio - net_profit_margin, 
    family = binomial, data = banks.train)

Coefficients:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -8.32065    0.71535 -11.632  &lt; 2e-16 ***
ITEM7240                      -0.03971    0.05860  -0.678 0.497996    
ITEM3255                      -0.06188    0.04383  -1.412 0.157987    
ITEM3999                       0.21258    0.06248   3.402 0.000668 ***
ITEM8381                       0.19661    0.07564   2.599 0.009340 ** 
ITEM15025                      0.42920    0.06343   6.766 1.32e-11 ***
ITEM15173                      0.52956    0.11005   4.812 1.49e-06 ***
ITEM75465                    -13.86652  335.27513  -0.041 0.967010    
ITEM75466                     -1.75807    0.17284 -10.172  &lt; 2e-16 ***
ITEM75467                    -14.17957  587.39191  -0.024 0.980741    
ITEM9104                      -0.36185    0.05074  -7.131 9.96e-13 ***
ITEM9304                       0.26456    0.07399   3.576 0.000350 ***
ITEM3998                       0.30117    0.08203   3.671 0.000241 ***
ITEM3995                      -0.35851    0.08031  -4.464 8.03e-06 ***
ITEM2004                       0.01070    0.02866   0.373 0.709022    
ITEM3019                      -0.09015    0.03355  -2.687 0.007199 ** 
big4_auditor1                  1.42880    0.21365   6.688 2.27e-11 ***
total_capital_adequacy_ratio   0.46172    0.18683   2.471 0.013462 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2419.1  on 13530  degrees of freedom
Residual deviance: 1963.2  on 13513  degrees of freedom
AIC: 1999.2

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a confusion matrix</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default cut off point to classify the default as 0.5</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use model to predict probability of AAER</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get test accuracy</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>predicted4<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">predict</span>(log.fit4<span class="fl">.1</span>, banks.test, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>confmat.test4<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.factor</span>(<span class="fu">ifelse</span>(predicted4<span class="fl">.1</span><span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="st">"1"</span>,<span class="st">"0"</span>)),banks.test<span class="sc">$</span>AAER)</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>confmat.test4<span class="fl">.1</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 5675  116
  1    3    5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> (confmat.test4<span class="fl">.1</span>[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4<span class="fl">.1</span>[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.test4<span class="fl">.1</span>[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4<span class="fl">.1</span>[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmat.test4<span class="fl">.1</span>[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4<span class="fl">.1</span>[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9794792</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Accuracy:97.95%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="log-reg-4.2" class="level3">
<h3 class="anchored" data-anchor-id="log-reg-4.2">2.2.11 Log Reg 4.2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuation of Log Reg 4</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>log.fit4<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(AAER<span class="sc">~</span>. <span class="sc">-</span>year<span class="sc">-</span>ITEM3255<span class="sc">-</span>ITEM7240<span class="sc">-</span>ITEM3255<span class="sc">-</span>ITEM8381<span class="sc">-</span>ITEM8311<span class="sc">-</span>ITEM8316<span class="sc">-</span>ITEM8906<span class="sc">-</span>ITEM15061<span class="sc">-</span>ITEM15073<span class="sc">-</span>ITEM3995<span class="sc">-</span>ITEM2004<span class="sc">-</span>leverage_ratio, <span class="at">data=</span>banks.train, <span class="at">family=</span>binomial)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.fit4<span class="fl">.2</span>) <span class="co">#AIC = 1972.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = AAER ~ . - year - ITEM3255 - ITEM7240 - ITEM3255 - 
    ITEM8381 - ITEM8311 - ITEM8316 - ITEM8906 - ITEM15061 - ITEM15073 - 
    ITEM3995 - ITEM2004 - leverage_ratio, family = binomial, 
    data = banks.train)

Coefficients:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -7.11838    0.80362  -8.858  &lt; 2e-16 ***
ITEM8236                      -0.40332    0.07237  -5.573 2.50e-08 ***
ITEM8301                       0.09025    0.09095   0.992  0.32105    
ITEM3999                       0.03694    0.06056   0.610  0.54186    
ITEM8231                       0.33682    0.06851   4.916 8.82e-07 ***
ITEM8361                      -0.25707    0.08365  -3.073  0.00212 ** 
ITEM15025                      0.37602    0.06531   5.757 8.55e-09 ***
ITEM15156                      0.31745    0.12441   2.552  0.01072 *  
ITEM15173                      0.57486    0.11045   5.205 1.94e-07 ***
ITEM75465                    -13.88207  335.81729  -0.041  0.96703    
ITEM75466                     -1.81403    0.17178 -10.560  &lt; 2e-16 ***
ITEM75467                    -14.09298  579.60848  -0.024  0.98060    
ITEM9104                      -0.40505    0.05125  -7.903 2.72e-15 ***
ITEM9304                       0.38470    0.07366   5.223 1.76e-07 ***
ITEM3998                       0.09591    0.06265   1.531  0.12583    
ITEM18156                     -0.06559    0.03366  -1.949  0.05131 .  
ITEM3019                      -0.08033    0.03457  -2.324  0.02014 *  
big4_auditor1                  1.68219    0.22167   7.589 3.23e-14 ***
total_capital_adequacy_ratio   0.46018    0.18298   2.515  0.01191 *  
net_profit_margin             -0.08996    0.05348  -1.682  0.09256 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2419.1  on 13530  degrees of freedom
Residual deviance: 1932.0  on 13511  degrees of freedom
AIC: 1972

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a confusion matrix</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default cut off point to classify the default as 0.5</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use model to predict probability of AAER</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get test accuracy</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>predicted4<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">predict</span>(log.fit4<span class="fl">.2</span>, banks.test, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>confmat.test4<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.factor</span>(<span class="fu">ifelse</span>(predicted4<span class="fl">.2</span><span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="st">"1"</span>,<span class="st">"0"</span>)),banks.test<span class="sc">$</span>AAER)</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>confmat.test4<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 5675  112
  1    3    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> (confmat.test4<span class="fl">.2</span>[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4<span class="fl">.2</span>[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.test4<span class="fl">.2</span>[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4<span class="fl">.2</span>[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmat.test4<span class="fl">.2</span>[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4<span class="fl">.2</span>[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.980169</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Accuracy: 98.02% </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="log-reg-4.3" class="level3">
<h3 class="anchored" data-anchor-id="log-reg-4.3">2.2.12 Log Reg 4.3</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuation of Log Reg 4</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>log.fit4<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(AAER<span class="sc">~</span>. <span class="sc">-</span>year<span class="sc">-</span>ITEM3255<span class="sc">-</span>ITEM7240<span class="sc">-</span>ITEM3255<span class="sc">-</span>ITEM8381<span class="sc">-</span>ITEM8311<span class="sc">-</span>ITEM8316<span class="sc">-</span>ITEM8906<span class="sc">-</span>ITEM15061<span class="sc">-</span>ITEM15073<span class="sc">-</span>ITEM3995<span class="sc">-</span>ITEM2004<span class="sc">-</span>leverage_ratio<span class="sc">-</span>ITEM3998<span class="sc">-</span>ITEM8361<span class="sc">-</span>ITEM8301, <span class="at">data=</span>banks.train, <span class="at">family=</span>binomial)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.fit4<span class="fl">.3</span>) <span class="co">#AIC = 1978.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = AAER ~ . - year - ITEM3255 - ITEM7240 - ITEM3255 - 
    ITEM8381 - ITEM8311 - ITEM8316 - ITEM8906 - ITEM15061 - ITEM15073 - 
    ITEM3995 - ITEM2004 - leverage_ratio - ITEM3998 - ITEM8361 - 
    ITEM8301, family = binomial, data = banks.train)

Coefficients:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -7.61417    0.78491  -9.701  &lt; 2e-16 ***
ITEM8236                      -0.36350    0.07276  -4.996 5.86e-07 ***
ITEM3999                       0.10788    0.04773   2.260  0.02381 *  
ITEM8231                       0.38208    0.06715   5.690 1.27e-08 ***
ITEM15025                      0.45009    0.06076   7.407 1.29e-13 ***
ITEM15156                      0.33552    0.12450   2.695  0.00704 ** 
ITEM15173                      0.51571    0.11027   4.677 2.91e-06 ***
ITEM75465                    -14.01993  333.35950  -0.042  0.96645    
ITEM75466                     -1.87562    0.16714 -11.222  &lt; 2e-16 ***
ITEM75467                    -14.14754  579.26610  -0.024  0.98052    
ITEM9104                      -0.40247    0.05152  -7.812 5.62e-15 ***
ITEM9304                       0.38994    0.07171   5.437 5.41e-08 ***
ITEM18156                     -0.05857    0.03347  -1.750  0.08010 .  
ITEM3019                      -0.07430    0.03474  -2.139  0.03247 *  
big4_auditor1                  1.72024    0.21744   7.912 2.54e-15 ***
total_capital_adequacy_ratio   0.40906    0.17812   2.297  0.02164 *  
net_profit_margin             -0.09175    0.04878  -1.881  0.05997 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2419.1  on 13530  degrees of freedom
Residual deviance: 1944.4  on 13514  degrees of freedom
AIC: 1978.4

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a confusion matrix</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default cut off point to classify the default as 0.5</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use model to predict probability of AAER</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get test accuracy</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>predicted4<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">predict</span>(log.fit4<span class="fl">.3</span>, banks.test, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>confmat.test4<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.factor</span>(<span class="fu">ifelse</span>(predicted4<span class="fl">.3</span><span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="st">"1"</span>,<span class="st">"0"</span>)),banks.test<span class="sc">$</span>AAER)</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>confmat.test4<span class="fl">.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       0    1
  0 5677  114
  1    1    7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> (confmat.test4<span class="fl">.3</span>[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4<span class="fl">.3</span>[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.test4<span class="fl">.3</span>[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4<span class="fl">.3</span>[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmat.test4<span class="fl">.3</span>[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4<span class="fl">.3</span>[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.980169</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Accuracy: 98.02%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comparing-auc-of-all-models" class="level3">
<h3 class="anchored" data-anchor-id="comparing-auc-of-all-models">2.2.13 Comparing AUC of all models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>auc_log.fit4 <span class="ot">&lt;-</span> <span class="fu">auc</span>(banks.test<span class="sc">$</span>AAER,predicted4,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>auc_log.fit4<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">auc</span>(banks.test<span class="sc">$</span>AAER,predicted4<span class="fl">.1</span>,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>auc_log.fit4<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">auc</span>(banks.test<span class="sc">$</span>AAER,predicted4<span class="fl">.2</span>,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>auc_log.fit4<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">auc</span>(banks.test<span class="sc">$</span>AAER,predicted4<span class="fl">.3</span>,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>auc_log.fit2 <span class="ot">&lt;-</span> <span class="fu">auc</span>(banks.test<span class="sc">$</span>AAER,predicted2,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>auc_log.fit2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">auc</span>(banks.test<span class="sc">$</span>AAER,predicted2<span class="fl">.1</span>,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>auc_log.fit2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">auc</span>(banks.test<span class="sc">$</span>AAER,predicted2<span class="fl">.2</span>,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to store results</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>aucs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"log_model"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"log.fit4"</span>,<span class="st">"log.fit4.1"</span>,<span class="st">"log.fit4.2"</span>,<span class="st">"log.fit4.3"</span>,<span class="st">"log.fit2"</span>,<span class="st">"log.fit2.1"</span>,<span class="st">"log.fit2.2"</span>),</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"AUC"</span> <span class="ot">=</span> <span class="fu">c</span>(auc_log.fit4, auc_log.fit4<span class="fl">.1</span>, auc_log.fit4<span class="fl">.2</span>,auc_log.fit4<span class="fl">.3</span>,auc_log.fit2,auc_log.fit2<span class="fl">.1</span>,auc_log.fit2<span class="fl">.2</span>),</span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"AIC"</span> <span class="ot">=</span> <span class="fu">c</span>(log.fit4<span class="sc">$</span>aic, log.fit4<span class="fl">.1</span><span class="sc">$</span>aic, log.fit4<span class="fl">.2</span><span class="sc">$</span>aic, log.fit4<span class="fl">.3</span><span class="sc">$</span>aic,log.fit2<span class="sc">$</span>aic,log.fit2<span class="fl">.1</span><span class="sc">$</span>aic,log.fit2<span class="fl">.2</span><span class="sc">$</span>aic))</span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>aucs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   log_model       AUC      AIC
1   log.fit4 0.8475965 1968.208
2 log.fit4.1 0.8489807 1999.189
3 log.fit4.2 0.8541333 1972.023
4 log.fit4.3 0.8530867 1978.350
5   log.fit2 0.8480433 1968.893
6 log.fit2.1 0.8508219 1976.263
7 log.fit2.2 0.8508438 1979.358</code></pre>
</div>
</div>
<p><em>Observations</em>:</p>
<p>Model 4.2 has attained the highest AUC of 0.8541 and the third lowest AIC.</p>
</section>
<section id="plotting-auc" class="level3">
<h3 class="anchored" data-anchor-id="plotting-auc">2.2.14 Plotting AUC</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>banks1 <span class="ot">&lt;-</span> banks.test</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>banks1<span class="sc">$</span>predicted4 <span class="ot">&lt;-</span> predicted4</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>banks1<span class="sc">$</span>predicted4<span class="fl">.1</span> <span class="ot">&lt;-</span> predicted4<span class="fl">.1</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>banks1<span class="sc">$</span>predicted4<span class="fl">.2</span> <span class="ot">&lt;-</span> predicted4<span class="fl">.2</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>banks1<span class="sc">$</span>predicted4<span class="fl">.3</span> <span class="ot">&lt;-</span> predicted4<span class="fl">.3</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>banks1<span class="sc">$</span>predicted2 <span class="ot">&lt;-</span> predicted2</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>banks1<span class="sc">$</span>predicted2<span class="fl">.1</span> <span class="ot">&lt;-</span> predicted2<span class="fl">.1</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>banks1<span class="sc">$</span>predicted2<span class="fl">.2</span> <span class="ot">&lt;-</span> predicted2<span class="fl">.2</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>curve_4 <span class="ot">&lt;-</span> banks1 <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER,predicted4,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>curve_4<span class="fl">.1</span> <span class="ot">&lt;-</span> banks1 <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER,predicted4<span class="fl">.1</span>,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>curve_4<span class="fl">.2</span> <span class="ot">&lt;-</span> banks1 <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER,predicted4<span class="fl">.2</span>,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>curve_4<span class="fl">.3</span> <span class="ot">&lt;-</span> banks1 <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER,predicted4<span class="fl">.3</span>,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>curve_2 <span class="ot">&lt;-</span> banks1 <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER,predicted2,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>curve_2<span class="fl">.1</span> <span class="ot">&lt;-</span> banks1 <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER,predicted2<span class="fl">.1</span>,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>curve_2<span class="fl">.2</span> <span class="ot">&lt;-</span> banks1 <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER,predicted2<span class="fl">.2</span>,<span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> curve_4, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity, <span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color=</span><span class="st">"logfit4"</span>)) <span class="sc">+</span></span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> curve_4<span class="fl">.1</span>, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity, <span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color=</span><span class="st">"logfit4.1"</span>)) <span class="sc">+</span></span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> curve_4<span class="fl">.2</span>, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity, <span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color=</span><span class="st">"logfit4.2"</span>)) <span class="sc">+</span></span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> curve_4<span class="fl">.3</span>, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity, <span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color=</span><span class="st">"logfit4.3"</span>)) <span class="sc">+</span></span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> curve_2, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity, <span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color=</span><span class="st">"logfit2"</span>)) <span class="sc">+</span></span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> curve_2<span class="fl">.1</span>, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity, <span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color=</span><span class="st">"logfit2.1"</span>)) <span class="sc">+</span></span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> curve_4<span class="fl">.3</span>, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity, <span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color=</span><span class="st">"logfit2.2"</span>)) <span class="sc">+</span></span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Observations</em>:</p>
<ol type="1">
<li>All the models have approximately the same classification accuracy of 98%.</li>
</ol>
<!-- -->
<ol start="2" type="1">
<li><p>Based on the results, logistic model <code>log.fit4.2</code> is the best because it has the highest AUC while having the third lowest AIC.</p></li>
<li><p><code>log.fit4.2</code> results: AUC = 0.854133, AIC = 1972.023</p></li>
</ol>
</section>
<section id="log-reg-4.2-on-all-data" class="level3">
<h3 class="anchored" data-anchor-id="log-reg-4.2-on-all-data">2.2.15 Log Reg 4.2 ON ALL DATA</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's continue to remove statistically insignificant variables.</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>log.fitall4<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(AAER<span class="sc">~</span>. <span class="sc">-</span>year<span class="sc">-</span>ITEM3255<span class="sc">-</span>ITEM7240<span class="sc">-</span>ITEM3255<span class="sc">-</span>ITEM8381<span class="sc">-</span>ITEM8311<span class="sc">-</span>ITEM8316<span class="sc">-</span>ITEM8906<span class="sc">-</span>ITEM15061<span class="sc">-</span>ITEM15073<span class="sc">-</span>ITEM3995<span class="sc">-</span>ITEM2004<span class="sc">-</span>leverage_ratio, <span class="at">data=</span>banks, <span class="at">family=</span>binomial)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log.fitall4<span class="fl">.2</span>) <span class="co">#AIC = 2846</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = AAER ~ . - year - ITEM3255 - ITEM7240 - ITEM3255 - 
    ITEM8381 - ITEM8311 - ITEM8316 - ITEM8906 - ITEM15061 - ITEM15073 - 
    ITEM3995 - ITEM2004 - leverage_ratio, family = binomial, 
    data = banks)

Coefficients:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -8.22268    0.66587 -12.349  &lt; 2e-16 ***
ITEM8236                      -0.37565    0.06110  -6.148 7.83e-10 ***
ITEM8301                       0.08172    0.07634   1.070  0.28441    
ITEM3999                       0.06554    0.04972   1.318  0.18749    
ITEM8231                       0.36701    0.05810   6.317 2.67e-10 ***
ITEM8361                      -0.19809    0.06931  -2.858  0.00426 ** 
ITEM15025                      0.40472    0.05481   7.384 1.54e-13 ***
ITEM15156                      0.33316    0.10267   3.245  0.00117 ** 
ITEM15173                      0.68025    0.08970   7.584 3.36e-14 ***
ITEM75465                    -15.24051  248.43291  -0.061  0.95108    
ITEM75466                     -1.96121    0.14178 -13.833  &lt; 2e-16 ***
ITEM75467                    -14.29726  515.08477  -0.028  0.97786    
ITEM9104                      -0.38381    0.04720  -8.131 4.24e-16 ***
ITEM9304                       0.46358    0.06207   7.468 8.13e-14 ***
ITEM3998                       0.09343    0.05086   1.837  0.06622 .  
ITEM18156                     -0.07200    0.02743  -2.625  0.00867 ** 
ITEM3019                      -0.05832    0.02892  -2.016  0.04375 *  
big4_auditor1                  1.57243    0.18141   8.668  &lt; 2e-16 ***
total_capital_adequacy_ratio   0.46578    0.14686   3.172  0.00152 ** 
net_profit_margin             -0.09933    0.04513  -2.201  0.02772 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 3597.1  on 19329  degrees of freedom
Residual deviance: 2806.0  on 19310  degrees of freedom
AIC: 2846

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a confusion matrix</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the default cut off point to classify the default as 0.5</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use model to predict probability of AAER</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now get test accuracy</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>predictedall4<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">predict</span>(log.fitall4<span class="fl">.2</span>, banks, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>confmatall.test4<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.factor</span>(<span class="fu">ifelse</span>(predictedall4<span class="fl">.2</span><span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="st">"1"</span>,<span class="st">"0"</span>)),banks<span class="sc">$</span>AAER)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>confmatall.test4<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
        0     1
  0 18957   328
  1    11    34</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> (confmat.test4<span class="fl">.2</span>[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4<span class="fl">.2</span>[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="sc">/</span> (confmat.test4<span class="fl">.2</span>[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4<span class="fl">.2</span>[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> confmatall.test4<span class="fl">.2</span>[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> confmat.test4<span class="fl">.2</span>[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9449709</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Accuracy: 94.50%  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Observations</em>:</p>
<p>Lastly, we have also tried logfit 4.2 on all data instead of just test data as logfit 4.2 gave us the highest AUC. We wanted to test if the AUC will increase for all banks data, however, we achieved a lower AUC as compared to logfit 4.2.</p>
</section>
</section>
<section id="lasso" class="level2">
<h2 class="anchored" data-anchor-id="lasso">2.3 Lasso</h2>
<section id="cv.glm-lasso-based-on-log-fit-4" class="level3">
<h3 class="anchored" data-anchor-id="cv.glm-lasso-based-on-log-fit-4">2.3.1 CV.GLM Lasso based on Log Fit 4</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Since we are not using parsnip regression, we converted AAER back to numeric.</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This is because factorised variables are not allowed in a matrix.</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>banks2 <span class="ot">&lt;-</span> banks <span class="sc">%&gt;%</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AAER =</span> <span class="fu">as.numeric</span>(AAER),</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">big4_auditor =</span> <span class="fu">as.numeric</span>(big4_auditor))</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define new training and test sets</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>train2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(banks2), <span class="dv">13531</span>)</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(banks2), train2)</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>banks2.train <span class="ot">&lt;-</span> banks2[train2,]</span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>banks2.test <span class="ot">&lt;-</span> banks2[test2,]</span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the formula</span></span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a>equation <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"AAER~ITEM7240+ITEM8236+ITEM3255+ITEM3999+ITEM8231+ITEM8381+ITEM8311+ITEM8316+ITEM8906+ITEM8361+ITEM15025+ITEM15061+ITEM15073+ITEM15156+ITEM15173+ITEM9104+ITEM9304+ITEM3998+ITEM18156+ITEM3995+ITEM2004+ITEM3019+leverage_ratio+total_capital_adequacy_ratio+net_profit_margin+big4_auditor"</span>))</span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add to recipe</span></span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a>rec2 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(equation,<span class="at">data=</span>banks2.train) <span class="sc">%&gt;%</span></span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_center</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span> <span class="co">#center all prediction variables</span></span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_scale</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span> <span class="co">#scale all prediction variables to Z-score</span></span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_intercept</span>()</span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(banks2.train<span class="sc">$</span>big4_auditor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:13531] 1 1 2 2 1 1 2 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prep the data</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="do">## We cannot use indicator variables in Lasso.</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>prepped2 <span class="ot">&lt;-</span> rec2 <span class="sc">%&gt;%</span> <span class="fu">prep</span>(<span class="at">training=</span>banks2.train)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>test_prepped2 <span class="ot">&lt;-</span> rec2 <span class="sc">%&gt;%</span> <span class="fu">prep</span>(<span class="at">training=</span>banks2.test)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>train_x <span class="ot">&lt;-</span> <span class="fu">juice</span>(prepped2,<span class="fu">all_predictors</span>(),<span class="at">composition=</span><span class="st">"dgCMatrix"</span>) <span class="co"># Change to tibble or change the binary back to numeric</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>train_y <span class="ot">&lt;-</span> <span class="fu">juice</span>(prepped2,<span class="fu">all_outcomes</span>(),<span class="at">composition=</span><span class="st">"matrix"</span>)</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>test_x <span class="ot">&lt;-</span> <span class="fu">juice</span>(test_prepped2,<span class="fu">all_predictors</span>(),<span class="at">composition=</span><span class="st">"dgCMatrix"</span>)</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>test_y <span class="ot">&lt;-</span> <span class="fu">juice</span>(test_prepped2,<span class="fu">all_outcomes</span>(),<span class="at">composition=</span><span class="st">"matrix"</span>)</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct cv</span></span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>cvfit <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(<span class="at">x=</span>train_x,<span class="at">y=</span>train_y, <span class="at">family =</span> <span class="st">'binomial'</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">type.measure =</span> <span class="st">'auc'</span>)</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the lambda that corresponds to min error</span></span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a><span class="co"># lambda.min refers to the value of the regularisation parameter (λ) that minimises the cross-validated error or some other criterion, typically chosen using techniques like cross-validation.</span></span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>cvfit<span class="sc">$</span>lambda.min </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.316746e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>cvfit<span class="sc">$</span>lambda<span class="fl">.1</span>se</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002394959</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cvfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the coefficient</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coefplot</span>(cvfit, <span class="at">lambda =</span> <span class="st">'lambda.min'</span>, <span class="at">sort =</span> <span class="st">'magnitude'</span>, <span class="at">title =</span> <span class="st">"coefplot with lambda.min"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefplot</span>(cvfit, <span class="at">lambda =</span> <span class="st">'lambda.1se'</span>, <span class="at">sort =</span> <span class="st">'magnitude'</span>, <span class="at">title =</span> <span class="st">"coefplot with lambda.1se"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-33-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coefficients</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(cvfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>28 x 1 sparse Matrix of class "dgCMatrix"
                                      s1
(Intercept)                  -4.36504137
intercept                     .         
ITEM7240                      .         
ITEM8236                     -0.06301345
ITEM3255                      .         
ITEM3999                      0.03982513
ITEM8231                      0.03463645
ITEM8381                      0.19163142
ITEM8311                      .         
ITEM8316                     -0.02284346
ITEM8906                      .         
ITEM8361                     -0.20191448
ITEM15025                     0.32120281
ITEM15061                     .         
ITEM15073                     .         
ITEM15156                     0.06431847
ITEM15173                     0.21937190
ITEM9104                     -0.27313003
ITEM9304                      0.17332104
ITEM3998                      .         
ITEM18156                     .         
ITEM3995                      .         
ITEM2004                      .         
ITEM3019                      .         
leverage_ratio                .         
total_capital_adequacy_ratio  0.02622481
net_profit_margin             .         
big4_auditor                  0.38511230</code></pre>
</div>
</div>
<p><em>Observations</em>:</p>
<p>Big4_auditor has the highest coefficient estimate, indicating it has a relatively strong influence on AAER which is the response variable The Lasso model effectively performs variable selection by shrinking some coefficients to exactly zero, simplifying the model and reduces the risk of overfitting</p>
</section>
<section id="test-the-performance-of-the-cv-lasso-model" class="level3">
<h3 class="anchored" data-anchor-id="test-the-performance-of-the-cv-lasso-model">2.3.2 Test the performance of the CV Lasso model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using lambda.min</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>train.pred_lmin <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">predict</span>(cvfit, train_x, <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">s =</span> <span class="st">'lambda.min'</span>))</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>test.pred_lmin <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">predict</span>(cvfit, test_x, <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">s =</span> <span class="st">'lambda.min'</span>))</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Using lambda.1se</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>train.pred_1se <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">predict</span>(cvfit, train_x, <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">s =</span> <span class="st">'lambda.1se'</span>))</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>test.pred_1se <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">predict</span>(cvfit, test_x, <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">s =</span> <span class="st">'lambda.1se'</span>))</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 2 data frames to store the predicted y values for train and test set as well as the actual AAER</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="co"># For lambda.min</span></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>df_train_lmin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">train.pred_lmin=</span>train.pred_lmin, <span class="at">AAER=</span><span class="fu">factor</span>(banks2.train<span class="sc">$</span>AAER))</span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>df_test_lmin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">test.pred_lmin=</span>test.pred_lmin, <span class="at">AAER=</span><span class="fu">factor</span>(banks2.test<span class="sc">$</span>AAER))</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a><span class="co"># For lambda.1se</span></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>df_train_1se <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">train.pred_1se=</span>train.pred_1se, <span class="at">AAER=</span><span class="fu">factor</span>(banks2.train<span class="sc">$</span>AAER))</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>df_test_1se <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">test.pred_1se=</span>test.pred_1se, <span class="at">AAER=</span><span class="fu">factor</span>(banks2.test<span class="sc">$</span>AAER))</span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a><span class="co"># For lambda.min</span></span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a>auc_cv_lmin_train <span class="ot">&lt;-</span> df_train_lmin <span class="sc">%&gt;%</span> <span class="fu">roc_auc</span>(AAER, train.pred_lmin, <span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>auc_cv_lmin_test <span class="ot">&lt;-</span> df_test_lmin <span class="sc">%&gt;%</span> <span class="fu">roc_auc</span>(AAER, test.pred_lmin, <span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>curve_CV.min_train <span class="ot">&lt;-</span> df_train_lmin <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER, train.pred_lmin, <span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>curve_CV.min_test <span class="ot">&lt;-</span> df_test_lmin <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER, test.pred_lmin, <span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a><span class="co"># For lambda.1se</span></span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a>auc_cv_1se_train <span class="ot">&lt;-</span> df_train_1se <span class="sc">%&gt;%</span> <span class="fu">roc_auc</span>(AAER, train.pred_1se, <span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a>auc_cv_1se_test <span class="ot">&lt;-</span> df_test_1se <span class="sc">%&gt;%</span> <span class="fu">roc_auc</span>(AAER, test.pred_1se, <span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a>curve_CV<span class="fl">.1</span>se_train <span class="ot">&lt;-</span> df_train_1se <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER, train.pred_1se, <span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a>curve_CV<span class="fl">.1</span>se_test <span class="ot">&lt;-</span> df_test_1se <span class="sc">%&gt;%</span> <span class="fu">roc_curve</span>(AAER, test.pred_1se, <span class="at">event_level=</span><span class="st">'second'</span>)</span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Store results in data frame</span></span>
<span id="cb159-32"><a href="#cb159-32" aria-hidden="true" tabindex="-1"></a>aucs_CV  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"AUC"</span> <span class="ot">=</span> <span class="fu">c</span>(auc_cv_lmin_train<span class="sc">$</span>.estimate, auc_cv_lmin_test<span class="sc">$</span>.estimate, auc_cv_1se_train<span class="sc">$</span>.estimate, auc_cv_1se_test<span class="sc">$</span>.estimate),</span>
<span id="cb159-33"><a href="#cb159-33" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"model"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"In sample, lambda.min"</span>,<span class="st">"out sample, lambda.min"</span>,<span class="st">"In sample, lambda.1se"</span>,<span class="st">"out sample, lambda.1se"</span>))</span>
<span id="cb159-34"><a href="#cb159-34" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb159-35"><a href="#cb159-35" aria-hidden="true" tabindex="-1"></a>aucs_CV</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        AUC                  model
1 0.8130320  In sample, lambda.min
2 0.8153901 out sample, lambda.min
3 0.7903312  In sample, lambda.1se
4 0.8083075 out sample, lambda.1se</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the AUC</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> curve_CV.min_train, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity,<span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color =</span> <span class="st">"In sample, lambda.min"</span>)) <span class="sc">+</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> curve_CV.min_test, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity,<span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color =</span> <span class="st">"out sample, lambda.min"</span>)) <span class="sc">+</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> curve_CV<span class="fl">.1</span>se_train, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity,<span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color =</span> <span class="st">"In sample, lambda.1se"</span>)) <span class="sc">+</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> curve_CV<span class="fl">.1</span>se_test, <span class="fu">aes</span>(<span class="at">y=</span>sensitivity,<span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>specificity, <span class="at">color =</span> <span class="st">"out sample, lambda.1se"</span>)) <span class="sc">+</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Group-2-Transparently.AI-Project-V3_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Observations</em>:</p>
<p>In sample, lambda.min = 0.8130</p>
<p>Out of sample, lambda.min = 0.8154</p>
<p>In sample, lambda.1se = 0.7903</p>
<p>Out of sample, lambda.1se = 0.8083</p>
<ol type="1">
<li><p>In sample (training data): Lambda.min offers the highest performance with the least amount of complexity at 0.8130. Lambda.1se is 0.7903, a slightly reduced lambda value that produces a simpler model but yet produces good performance.</p></li>
<li><p>Out of Sample (testing data): When applied to unknown data, the ideal regularisation strength may differ, as evidenced by lambda.min, which is 0.8154 and shows a little larger lambda value than in the sample.The lambda value is marginally higher than in the sample, but it is still within one standard error of the lowest cross-validation error, as shown by Lambda.1se of 0.8083, which similarly indicates a similar pattern.</p></li>
</ol>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>3.0 Conclusion</h1>
<p>Overall, we have looked into the performance of various predictive models on our data set - XGBoost, Logistic Regression, and Lasso.</p>
<p>We started off with the implementation of the XGBoost model. However, it showed signs of over-fitting. Despite achieving an impressive train AUC of 0.9850 and a test AUC of 0.9283, we recognized the need to address this issue to ensure the model’s generalizability and the presence of the the imbalanced data problem.Therefore, we turned to logistic regression.</p>
<p>Leveraging insights from a correlation matrix, we meticulously pruned non-significant variables, refining our models to achieve optimal performance. Notably, Logistic Regression Models 2 and 4 emerged as front-runners as previously mentioned, exhibiting similar AIC values so we performed the same variable elimination processes on them to come up with our Log Fit Models.</p>
<p>Lastly, building upon the foundations laid by logistic regression model 4, we tried Lasso regression. The resulting model delivered promising results, with an in sample (lambda.min) of 0.8130, out of sample (lambda.min) of 0.8154, in sample (lambda.1se) of 0.7903 and out of sample (lambda.1se) of 0.8083.</p>
<p>Ultimately, our choice of model would be the Log Fit 4.2 regression model because it has attained the highest AUC among the other models and it also has one of the lowest AIC. This means out of all the models we have built and tested, this particular one has the best predictive ability to detect fraud.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>